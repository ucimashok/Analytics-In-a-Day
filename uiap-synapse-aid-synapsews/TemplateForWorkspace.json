{
	"$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
	"contentVersion": "1.0.0.0",
	"parameters": {
		"workspaceName": {
			"type": "string",
			"metadata": "Workspace name",
			"defaultValue": "uiap-synapse-aid-synapsews"
		},
		"asadatalake01_accountKey": {
			"type": "secureString",
			"metadata": "Secure string for 'accountKey' of 'asadatalake01'"
		},
		"asastore01_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'asastore01'"
		},
		"sqlpool01_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'sqlpool01'"
		},
		"uiap-synapse-aid-synapsews-WorkspaceDefaultSqlServer_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'uiap-synapse-aid-synapsews-WorkspaceDefaultSqlServer'"
		},
		"asadatalake01_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "https://uiapsynapseaiddl.dfs.core.windows.net"
		},
		"uiap-synapse-aid-synapsews-WorkspaceDefaultStorage_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "https://uiapsynapseaiddl.dfs.core.windows.net"
		}
	},
	"variables": {
		"workspaceId": "[concat('Microsoft.Synapse/workspaces/', parameters('workspaceName'))]"
	},
	"resources": [
		{
			"name": "[concat(parameters('workspaceName'), '/Exercise 2 - Enrich Data')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"description": "Pipeline for enriching data from DimCustomer with additional location information from an external data source.",
				"activities": [
					{
						"name": "Enrich Customer Data",
						"description": "Data flow that enriches the data from the DimCustomer table with location information from an external data source. The enriched data is then copied to a staging table in Azure Synapse Analytics.",
						"type": "ExecuteDataFlow",
						"dependsOn": [
							{
								"activity": "Import Customer dimension",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "EnrichCustomerData",
								"type": "DataFlowReference",
								"parameters": {
									"UniqueId": {
										"value": "'@{substring(pipeline().RunId,0,8)}'",
										"type": "Expression"
									}
								},
								"datasetParameters": {
									"PostalCodes": {},
									"DimCustomer": {
										"UniqueId": {
											"value": "@substring(pipeline().RunId,0,8)",
											"type": "Expression"
										}
									},
									"EnrichedCustomerData": {
										"UniqueId": {
											"value": "@substring(pipeline().RunId,0,8)",
											"type": "Expression"
										}
									},
									"EnrichedCustomerDataAdls": {}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 48,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "Import Customer dimension",
						"description": "Copies Customer data from files stored in a data lake, renames columns, and inserts the data into a staging version of the DimCustomer table in Azure Synapse Analytics.",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Source",
								"value": "dev/bronze/wwi-dimcustomer.csv"
							},
							{
								"name": "Destination",
								"value": "wwi_staging.@{concat('DimCustomer_',substring(pipeline().RunId,0,8))}"
							}
						],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "SqlDWSink",
								"tableOption": "autoCreate",
								"disableMetricsCollection": false
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "asadatalake01",
									"type": "LinkedServiceReference"
								},
								"path": "staging",
								"enableCompression": true
							},
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "Customer Key",
											"type": "Int32"
										},
										"sink": {
											"name": "CustomerKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "WWI Customer ID",
											"type": "Int32"
										},
										"sink": {
											"name": "WWICustomerID",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Customer",
											"type": "String"
										},
										"sink": {
											"name": "Customer",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Bill To Customer",
											"type": "String"
										},
										"sink": {
											"name": "BillToCustomer",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Category",
											"type": "String"
										},
										"sink": {
											"name": "Category",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Buying Group",
											"type": "String"
										},
										"sink": {
											"name": "BuyingGroup",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Primary Contact",
											"type": "String"
										},
										"sink": {
											"name": "PrimaryContact",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Postal Code",
											"type": "String"
										},
										"sink": {
											"name": "PostalCode",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Valid From",
											"type": "DateTime"
										},
										"sink": {
											"name": "ValidFrom",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "Valid To",
											"type": "DateTime"
										},
										"sink": {
											"name": "ValidTo",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "Lineage Key",
											"type": "Int32"
										},
										"sink": {
											"name": "LineageKey",
											"type": "Int32"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "wwi_dimcustomer_adls",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "wwi_staging_dimcustomer_asa",
								"type": "DatasetReference",
								"parameters": {
									"UniqueId": {
										"value": "@substring(pipeline().RunId,0,8)",
										"type": "Expression"
									}
								}
							}
						]
					}
				],
				"annotations": [],
				"lastPublishTime": "2021-06-03T07:03:13Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/dataflows/EnrichCustomerData')]",
				"[concat(variables('workspaceId'), '/datasets/wwi_dimcustomer_adls')]",
				"[concat(variables('workspaceId'), '/datasets/wwi_staging_dimcustomer_asa')]",
				"[concat(variables('workspaceId'), '/linkedServices/asadatalake01')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Import WWI Data - Fact Sale Full')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "Copy data1",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "SqlDWSink",
								"preCopyScript": "truncate table wwi.FactSale",
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": false
								},
								"disableMetricsCollection": false
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "asastore01",
									"type": "LinkedServiceReference"
								},
								"path": "staging"
							},
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "City Key",
											"type": "String"
										},
										"sink": {
											"name": "CityKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Customer Key",
											"type": "String"
										},
										"sink": {
											"name": "CustomerKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Bill To Customer Key",
											"type": "Int32"
										},
										"sink": {
											"name": "BillToCustomerKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Stock Item Key",
											"type": "Int32"
										},
										"sink": {
											"name": "StockItemKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Invoice Date Key",
											"type": "DateTime"
										},
										"sink": {
											"name": "InvoiceDateKey",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "Delivery Date Key",
											"type": "DateTime"
										},
										"sink": {
											"name": "DeliveryDateKey",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "Salesperson Key",
											"type": "Int32"
										},
										"sink": {
											"name": "SalespersonKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "WWI Invoice ID",
											"type": "Int32"
										},
										"sink": {
											"name": "WWIInvoiceID",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Description",
											"type": "String"
										},
										"sink": {
											"name": "Description",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Package",
											"type": "String"
										},
										"sink": {
											"name": "Package",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Quantity",
											"type": "Decimal"
										},
										"sink": {
											"name": "Quantity",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Unit Price",
											"type": "Decimal"
										},
										"sink": {
											"name": "UnitPrice",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "Tax Rate",
											"type": "Decimal"
										},
										"sink": {
											"name": "TaxRate",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "Total Excluding Tax",
											"type": "Decimal"
										},
										"sink": {
											"name": "TotalExcludingTax",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "Tax Amount",
											"type": "Decimal"
										},
										"sink": {
											"name": "TaxAmount",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "Profit",
											"type": "Decimal"
										},
										"sink": {
											"name": "Profit",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "Total Including Tax",
											"type": "Decimal"
										},
										"sink": {
											"name": "TotalIncludingTax",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "Total Dry Items",
											"type": "Int32"
										},
										"sink": {
											"name": "TotalDryItems",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Total Chiller Items",
											"type": "Int32"
										},
										"sink": {
											"name": "TotalChillerItems",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Lineage Key",
											"type": "Int32"
										},
										"sink": {
											"name": "LineageKey",
											"type": "Int32"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "wwi_factsale_adls",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "wwi_factsale_asa",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"annotations": [],
				"lastPublishTime": "2021-06-02T10:08:56Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/datasets/wwi_factsale_adls')]",
				"[concat(variables('workspaceId'), '/datasets/wwi_factsale_asa')]",
				"[concat(variables('workspaceId'), '/linkedServices/asastore01')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Import WWI Data')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "Import City dimension",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "SqlDWSink",
								"preCopyScript": "truncate table wwi.DimCity",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "City Key",
											"type": "Int32"
										},
										"sink": {
											"name": "CityKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "WWI City ID",
											"type": "Int32"
										},
										"sink": {
											"name": "WWICityID",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "City",
											"type": "String"
										},
										"sink": {
											"name": "City",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "State Province",
											"type": "String"
										},
										"sink": {
											"name": "StateProvince",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Country",
											"type": "String"
										},
										"sink": {
											"name": "Country",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Continent",
											"type": "String"
										},
										"sink": {
											"name": "Continent",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Sales Territory",
											"type": "String"
										},
										"sink": {
											"name": "SalesTerritory",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Region",
											"type": "String"
										},
										"sink": {
											"name": "Region",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Subregion",
											"type": "String"
										},
										"sink": {
											"name": "Subregion",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Latest Recorded Population",
											"type": "Int32"
										},
										"sink": {
											"name": "LatestRecordedPopulation",
											"type": "Int64"
										}
									},
									{
										"source": {
											"name": "Valid From",
											"type": "DateTime"
										},
										"sink": {
											"name": "ValidFrom",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "Valid To",
											"type": "DateTime"
										},
										"sink": {
											"name": "ValidTo",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "Lineage Key",
											"type": "Int32"
										},
										"sink": {
											"name": "LineageKey",
											"type": "Int32"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "wwi_dimcity_adls",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "wwi_dimcity_asa",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Import Customer dimension",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "SqlDWSink",
								"preCopyScript": "truncate table wwi.DimCustomer",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "Customer Key",
											"type": "Int32"
										},
										"sink": {
											"name": "CustomerKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "WWI Customer ID",
											"type": "Int32"
										},
										"sink": {
											"name": "WWICustomerID",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Customer",
											"type": "String"
										},
										"sink": {
											"name": "Customer",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Bill To Customer",
											"type": "String"
										},
										"sink": {
											"name": "BillToCustomer",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Category",
											"type": "String"
										},
										"sink": {
											"name": "Category",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Buying Group",
											"type": "String"
										},
										"sink": {
											"name": "BuyingGroup",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Primary Contact",
											"type": "String"
										},
										"sink": {
											"name": "PrimaryContact",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Postal Code",
											"type": "String"
										},
										"sink": {
											"name": "PostalCode",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Valid From",
											"type": "DateTime"
										},
										"sink": {
											"name": "ValidFrom",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "Valid To",
											"type": "DateTime"
										},
										"sink": {
											"name": "ValidTo",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "Lineage Key",
											"type": "Int32"
										},
										"sink": {
											"name": "LineageKey",
											"type": "Int32"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "wwi_dimcustomer_adls",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "wwi_dimcustomer_asa",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Import Date dimension",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "SqlDWSink",
								"preCopyScript": "truncate table wwi.DimDate",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "Date",
											"type": "DateTime"
										},
										"sink": {
											"name": "Date",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "Day Number",
											"type": "Int32"
										},
										"sink": {
											"name": "DayNumber",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Day",
											"type": "String"
										},
										"sink": {
											"name": "Day",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Month",
											"type": "String"
										},
										"sink": {
											"name": "Month",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Short Month",
											"type": "String"
										},
										"sink": {
											"name": "ShortMonth",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Calendar Month Number",
											"type": "Int32"
										},
										"sink": {
											"name": "CalendarMonthNumber",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Calendar Month Label",
											"type": "String"
										},
										"sink": {
											"name": "CalendarMonthLabel",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Calendar Year",
											"type": "Int32"
										},
										"sink": {
											"name": "CalendarYear",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Calendar Year Label",
											"type": "String"
										},
										"sink": {
											"name": "CalendarYearLabel",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Fiscal Month Number",
											"type": "Int32"
										},
										"sink": {
											"name": "FiscalMonthNumber",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Fiscal Month Label",
											"type": "String"
										},
										"sink": {
											"name": "FiscalMonthLabel",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Fiscal Year",
											"type": "Int32"
										},
										"sink": {
											"name": "FiscalYear",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Fiscal Year Label",
											"type": "String"
										},
										"sink": {
											"name": "FiscalYearLabel",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "ISO Week Number",
											"type": "Int32"
										},
										"sink": {
											"name": "ISOWeekNumber",
											"type": "Int32"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "wwi_dimdate_adls",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "wwi_dimdate_asa",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Import Employee dimension",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "SqlDWSink",
								"preCopyScript": "truncate table wwi.DimEmployee",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "Employee Key",
											"type": "Int32"
										},
										"sink": {
											"name": "EmployeeKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "WWI Employee ID",
											"type": "Int32"
										},
										"sink": {
											"name": "WWIEmployeeID",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Employee",
											"type": "String"
										},
										"sink": {
											"name": "Employee",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Preferred Name",
											"type": "String"
										},
										"sink": {
											"name": "PreferredName",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Is Salesperson",
											"type": "Boolean"
										},
										"sink": {
											"name": "IsSalesperson",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "Valid From",
											"type": "DateTime"
										},
										"sink": {
											"name": "ValidFrom",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "Valid To",
											"type": "DateTime"
										},
										"sink": {
											"name": "ValidTo",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "Lineage Key",
											"type": "Int32"
										},
										"sink": {
											"name": "LineageKey",
											"type": "Int32"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "wwi_dimemployee_adls",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "wwi_dimemployee_asa",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Import Payment Method dimension",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "SqlDWSink",
								"preCopyScript": "truncate table wwi.DimPaymentMethod",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "Payment Method Key",
											"type": "Int32"
										},
										"sink": {
											"name": "PaymentMethodKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "WWI Payment Method ID",
											"type": "Int32"
										},
										"sink": {
											"name": "WWIPaymentMethodID",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Payment Method",
											"type": "String"
										},
										"sink": {
											"name": "PaymentMethod",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Valid From",
											"type": "DateTime"
										},
										"sink": {
											"name": "ValidFrom",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "Valid To",
											"type": "DateTime"
										},
										"sink": {
											"name": "ValidTo",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "Lineage Key",
											"type": "Int32"
										},
										"sink": {
											"name": "LineageKey",
											"type": "Int32"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "wwi_dimpaymentmethod_adls",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "wwi_dimpaymentmethod_asa",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Import Stock Item dimension",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "SqlDWSink",
								"preCopyScript": "truncate table wwi.DimStockItem",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "Stock Item Key",
											"type": "Int32"
										},
										"sink": {
											"name": "StockItemKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "WWI Stock Item ID",
											"type": "Int32"
										},
										"sink": {
											"name": "WWIStockItemID",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Stock Item",
											"type": "String"
										},
										"sink": {
											"name": "Stock Item",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Color",
											"type": "String"
										},
										"sink": {
											"name": "Color",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Selling Package",
											"type": "String"
										},
										"sink": {
											"name": "SellingPackage",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Buying Package",
											"type": "String"
										},
										"sink": {
											"name": "Buying Package",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Brand",
											"type": "String"
										},
										"sink": {
											"name": "Brand",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Size",
											"type": "String"
										},
										"sink": {
											"name": "Size",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Lead Time Days",
											"type": "Int32"
										},
										"sink": {
											"name": "LeadTimeDays",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Quantity Per Outer",
											"type": "Int32"
										},
										"sink": {
											"name": "QuantityPerOuter",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Is Chiller Stock",
											"type": "Boolean"
										},
										"sink": {
											"name": "IsChillerStock",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "Barcode",
											"type": "String"
										},
										"sink": {
											"name": "Barcode",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Tax Rate",
											"type": "Decimal"
										},
										"sink": {
											"name": "TaxRate",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "Unit Price",
											"type": "Decimal"
										},
										"sink": {
											"name": "UnitPrice",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "Recommended Retail Price",
											"type": "Decimal"
										},
										"sink": {
											"name": "RecommendedRetailPrice",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "Typical Weight Per Unit",
											"type": "Decimal"
										},
										"sink": {
											"name": "TypicalWeightPerUnit",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "Valid From",
											"type": "DateTime"
										},
										"sink": {
											"name": "ValidFrom",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "Valid To",
											"type": "DateTime"
										},
										"sink": {
											"name": "ValidTo",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "Lineage Key",
											"type": "Int32"
										},
										"sink": {
											"name": "LineageKey",
											"type": "Int32"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "wwi_dimstockitem_adls",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "wwi_dimstockitem_asa",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Import Supplier dimension",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "SqlDWSink",
								"preCopyScript": "truncate table wwi.DimSupplier",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "Supplier Key",
											"type": "Int32"
										},
										"sink": {
											"name": "SupplierKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "WWI Supplier ID",
											"type": "Int32"
										},
										"sink": {
											"name": "WWISupplierID",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Supplier",
											"type": "String"
										},
										"sink": {
											"name": "Supplier",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Category",
											"type": "String"
										},
										"sink": {
											"name": "Category",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Primary Contact",
											"type": "String"
										},
										"sink": {
											"name": "PrimaryContact",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Supplier Reference",
											"type": "String"
										},
										"sink": {
											"name": "SupplierReference",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Payment Days",
											"type": "Int32"
										},
										"sink": {
											"name": "PaymentDays",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Postal Code",
											"type": "String"
										},
										"sink": {
											"name": "PostalCode",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Valid From",
											"type": "DateTime"
										},
										"sink": {
											"name": "ValidFrom",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "Valid To",
											"type": "DateTime"
										},
										"sink": {
											"name": "ValidTo",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "Lineage Key",
											"type": "Int32"
										},
										"sink": {
											"name": "LineageKey",
											"type": "Int32"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "wwi_dimsupplier_adls",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "wwi_dimsupplier_asa",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Import Transaction Type dimension",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "SqlDWSink",
								"preCopyScript": "truncate table wwi.DimTransactionType",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "Transaction Type Key",
											"type": "Int32"
										},
										"sink": {
											"name": "TransactionTypeKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "WWI Transaction Type ID",
											"type": "Int32"
										},
										"sink": {
											"name": "WWITransactionTypeID",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Transaction Type",
											"type": "String"
										},
										"sink": {
											"name": "TransactionType",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Valid From",
											"type": "DateTime"
										},
										"sink": {
											"name": "ValidFrom",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "Valid To",
											"type": "DateTime"
										},
										"sink": {
											"name": "ValidTo",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "Lineage Key",
											"type": "Int32"
										},
										"sink": {
											"name": "LineageKey",
											"type": "Int32"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "wwi_dimtransactiontype_adls",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "wwi_dimtransactiontype_asa",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Import Movement fact",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "SqlDWSink",
								"preCopyScript": "truncate table wwi.FactMovement",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "Date Key",
											"type": "DateTime"
										},
										"sink": {
											"name": "DateKey",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "Stock Item Key",
											"type": "Int32"
										},
										"sink": {
											"name": "StockItemKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Customer Key",
											"type": "String"
										},
										"sink": {
											"name": "CustomerKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Supplier Key",
											"type": "String"
										},
										"sink": {
											"name": "SupplierKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Transaction Type Key",
											"type": "Int32"
										},
										"sink": {
											"name": "TransactionTypeKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "WWI Stock Item Transaction ID",
											"type": "Int32"
										},
										"sink": {
											"name": "WWIStockItemTransactionID",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "WWI Invoice ID",
											"type": "Int32"
										},
										"sink": {
											"name": "WWIInvoiceID",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "WWI Purchase Order ID",
											"type": "Int32"
										},
										"sink": {
											"name": "WWIPurchaseOrderID",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Quantity",
											"type": "Int32"
										},
										"sink": {
											"name": "Quantity",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Lineage Key",
											"type": "Int32"
										},
										"sink": {
											"name": "LineageKey",
											"type": "Int32"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "wwi_factmovement_adls",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "wwi_factmovement_asa",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Import Order fact",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "SqlDWSink",
								"preCopyScript": "truncate table wwi.FactOrder",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "City Key",
											"type": "Int32"
										},
										"sink": {
											"name": "CityKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Customer Key",
											"type": "Int32"
										},
										"sink": {
											"name": "CustomerKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Stock Item Key",
											"type": "Int32"
										},
										"sink": {
											"name": "StockItemKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Order Date Key",
											"type": "DateTime"
										},
										"sink": {
											"name": "OrderDateKey",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "Picked Date Key",
											"type": "DateTime"
										},
										"sink": {
											"name": "PickedDateKey",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "Salesperson Key",
											"type": "Int32"
										},
										"sink": {
											"name": "SalespersonKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Picker Key",
											"type": "Int32"
										},
										"sink": {
											"name": "PickerKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "WWI Order ID",
											"type": "Int32"
										},
										"sink": {
											"name": "WWIOrderID",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "WWI Backorder ID",
											"type": "Int32"
										},
										"sink": {
											"name": "WWIBackorderID",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Description",
											"type": "String"
										},
										"sink": {
											"name": "Description",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Package",
											"type": "String"
										},
										"sink": {
											"name": "Package",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Quantity",
											"type": "Int32"
										},
										"sink": {
											"name": "Quantity",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Unit Price",
											"type": "Decimal"
										},
										"sink": {
											"name": "UnitPrice",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "Tax Rate",
											"type": "Decimal"
										},
										"sink": {
											"name": "TaxRate",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "Total Excluding Tax",
											"type": "Decimal"
										},
										"sink": {
											"name": "TotalExcludingTax",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "Tax Amount",
											"type": "Decimal"
										},
										"sink": {
											"name": "TaxAmount",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "Total Including Tax",
											"type": "Decimal"
										},
										"sink": {
											"name": "TotalIncludingTax",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "Lineage Key",
											"type": "Int32"
										},
										"sink": {
											"name": "LineageKey",
											"type": "Int32"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "wwi_factorder_adls",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "wwi_factorder_asa",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Import Purchase fact",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "SqlDWSink",
								"preCopyScript": "truncate table wwi.FactPurchase",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "Date Key",
											"type": "DateTime"
										},
										"sink": {
											"name": "DateKey",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "Supplier Key",
											"type": "Int32"
										},
										"sink": {
											"name": "SupplierKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Stock Item Key",
											"type": "Int32"
										},
										"sink": {
											"name": "StockItemKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "WWI Purchase Order ID",
											"type": "Int32"
										},
										"sink": {
											"name": "WWIPurchaseOrderID",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Ordered Outers",
											"type": "Int32"
										},
										"sink": {
											"name": "OrderedOuters",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Ordered Quantity",
											"type": "Int32"
										},
										"sink": {
											"name": "OrderedQuantity",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Received Outers",
											"type": "Int32"
										},
										"sink": {
											"name": "ReceivedOuters",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Package",
											"type": "String"
										},
										"sink": {
											"name": "Package",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Is Order Finalized",
											"type": "Boolean"
										},
										"sink": {
											"name": "IsOrderFinalized",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "Lineage Key",
											"type": "Int32"
										},
										"sink": {
											"name": "LineageKey",
											"type": "Int32"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "wwi_factpurchase_adls",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "wwi_factpurchase_asa",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Import Stock Holding fact",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "SqlDWSink",
								"preCopyScript": "truncate table wwi.FactStockHolding",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "Stock Item Key",
											"type": "Int32"
										},
										"sink": {
											"name": "StockItemKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Quantity On Hand",
											"type": "Int32"
										},
										"sink": {
											"name": "QuantityOnHand",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Bin Location",
											"type": "String"
										},
										"sink": {
											"name": "BinLocation",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Last Stocktake Quantity",
											"type": "Int32"
										},
										"sink": {
											"name": "LastStocktakeQuantity",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Last Cost Price",
											"type": "Decimal"
										},
										"sink": {
											"name": "LastCostPrice",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "Reorder Level",
											"type": "Int32"
										},
										"sink": {
											"name": "ReorderLevel",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Target Stock Level",
											"type": "Int32"
										},
										"sink": {
											"name": "TargetStockLevel",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Lineage Key",
											"type": "Int32"
										},
										"sink": {
											"name": "LineageKey",
											"type": "Int32"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "wwi_factstockholding_adls",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "wwi_factstockholding_asa",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Import Transaction fact",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "SqlDWSink",
								"preCopyScript": "truncate table wwi.FactTransaction",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "Date Key",
											"type": "DateTime"
										},
										"sink": {
											"name": "DateKey",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "Customer Key",
											"type": "Int32"
										},
										"sink": {
											"name": "CustomerKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Bill To Customer Key",
											"type": "Int32"
										},
										"sink": {
											"name": "BillToCustomerKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Supplier Key",
											"type": "Int32"
										},
										"sink": {
											"name": "SupplierKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Transaction Type Key",
											"type": "Int32"
										},
										"sink": {
											"name": "TransactionTypeKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Payment Method Key",
											"type": "Int32"
										},
										"sink": {
											"name": "PaymentMethodKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "WWI Customer Transaction ID",
											"type": "Int32"
										},
										"sink": {
											"name": "WWICustomerTransaction ID",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "WWI Supplier Transaction ID",
											"type": "Int32"
										},
										"sink": {
											"name": "WWISupplierTransaction ID",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "WWI Invoice ID",
											"type": "Int32"
										},
										"sink": {
											"name": "WWIInvoiceID",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "WWI Purchase Order ID",
											"type": "Int32"
										},
										"sink": {
											"name": "WWIPurchaseOrderID",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Supplier Invoice Number",
											"type": "String"
										},
										"sink": {
											"name": "SupplierInvoiceNumber",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Total Excluding Tax",
											"type": "Decimal"
										},
										"sink": {
											"name": "TotalExcludingTax",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "Tax Amount",
											"type": "Decimal"
										},
										"sink": {
											"name": "TaxAmount",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "Total Including Tax",
											"type": "Decimal"
										},
										"sink": {
											"name": "TotalIncludingTax",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "Outstanding Balance",
											"type": "Decimal"
										},
										"sink": {
											"name": "OutstandingBalance",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "Is Finalized",
											"type": "Boolean"
										},
										"sink": {
											"name": "IsFinalized",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"name": "Lineage Key",
											"type": "Int32"
										},
										"sink": {
											"name": "LineageKey",
											"type": "Int32"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "wwi_facttransaction_adls",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "wwi_facttransaction_asa",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"annotations": [],
				"lastPublishTime": "2021-06-02T10:08:51Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/datasets/wwi_dimcity_adls')]",
				"[concat(variables('workspaceId'), '/datasets/wwi_dimcity_asa')]",
				"[concat(variables('workspaceId'), '/datasets/wwi_dimcustomer_adls')]",
				"[concat(variables('workspaceId'), '/datasets/wwi_dimcustomer_asa')]",
				"[concat(variables('workspaceId'), '/datasets/wwi_dimdate_adls')]",
				"[concat(variables('workspaceId'), '/datasets/wwi_dimdate_asa')]",
				"[concat(variables('workspaceId'), '/datasets/wwi_dimemployee_adls')]",
				"[concat(variables('workspaceId'), '/datasets/wwi_dimemployee_asa')]",
				"[concat(variables('workspaceId'), '/datasets/wwi_dimpaymentmethod_adls')]",
				"[concat(variables('workspaceId'), '/datasets/wwi_dimpaymentmethod_asa')]",
				"[concat(variables('workspaceId'), '/datasets/wwi_dimstockitem_adls')]",
				"[concat(variables('workspaceId'), '/datasets/wwi_dimstockitem_asa')]",
				"[concat(variables('workspaceId'), '/datasets/wwi_dimsupplier_adls')]",
				"[concat(variables('workspaceId'), '/datasets/wwi_dimsupplier_asa')]",
				"[concat(variables('workspaceId'), '/datasets/wwi_dimtransactiontype_adls')]",
				"[concat(variables('workspaceId'), '/datasets/wwi_dimtransactiontype_asa')]",
				"[concat(variables('workspaceId'), '/datasets/wwi_factmovement_adls')]",
				"[concat(variables('workspaceId'), '/datasets/wwi_factmovement_asa')]",
				"[concat(variables('workspaceId'), '/datasets/wwi_factorder_adls')]",
				"[concat(variables('workspaceId'), '/datasets/wwi_factorder_asa')]",
				"[concat(variables('workspaceId'), '/datasets/wwi_factpurchase_adls')]",
				"[concat(variables('workspaceId'), '/datasets/wwi_factpurchase_asa')]",
				"[concat(variables('workspaceId'), '/datasets/wwi_factstockholding_adls')]",
				"[concat(variables('workspaceId'), '/datasets/wwi_factstockholding_asa')]",
				"[concat(variables('workspaceId'), '/datasets/wwi_facttransaction_adls')]",
				"[concat(variables('workspaceId'), '/datasets/wwi_facttransaction_asa')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Import WWI Perf Data - Fact Sale Fast')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "Copy data part 1",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "SqlDWSink",
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": false
								},
								"disableMetricsCollection": false
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "asastore01",
									"type": "LinkedServiceReference"
								},
								"path": "staging"
							},
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "City Key",
											"type": "String"
										},
										"sink": {
											"name": "CityKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Customer Key",
											"type": "String"
										},
										"sink": {
											"name": "CustomerKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Bill To Customer Key",
											"type": "Int32"
										},
										"sink": {
											"name": "BillToCustomerKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Stock Item Key",
											"type": "Int32"
										},
										"sink": {
											"name": "StockItemKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Invoice Date Key",
											"type": "DateTime"
										},
										"sink": {
											"name": "InvoiceDateKey",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "Delivery Date Key",
											"type": "DateTime"
										},
										"sink": {
											"name": "DeliveryDateKey",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "Salesperson Key",
											"type": "Int32"
										},
										"sink": {
											"name": "SalespersonKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "WWI Invoice ID",
											"type": "Int32"
										},
										"sink": {
											"name": "WWIInvoiceID",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Description",
											"type": "String"
										},
										"sink": {
											"name": "Description",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Package",
											"type": "String"
										},
										"sink": {
											"name": "Package",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Quantity",
											"type": "Decimal"
										},
										"sink": {
											"name": "Quantity",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Unit Price",
											"type": "Decimal"
										},
										"sink": {
											"name": "UnitPrice",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "Tax Rate",
											"type": "Decimal"
										},
										"sink": {
											"name": "TaxRate",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "Total Excluding Tax",
											"type": "Decimal"
										},
										"sink": {
											"name": "TotalExcludingTax",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "Tax Amount",
											"type": "Decimal"
										},
										"sink": {
											"name": "TaxAmount",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "Profit",
											"type": "Decimal"
										},
										"sink": {
											"name": "Profit",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "Total Including Tax",
											"type": "Decimal"
										},
										"sink": {
											"name": "TotalIncludingTax",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "Total Dry Items",
											"type": "Int32"
										},
										"sink": {
											"name": "TotalDryItems",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Total Chiller Items",
											"type": "Int32"
										},
										"sink": {
											"name": "TotalChillerItems",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Lineage Key",
											"type": "Int32"
										},
										"sink": {
											"name": "LineageKey",
											"type": "Int32"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "wwi_factsale_big_1_adls",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "wwi_perf_factsale_fast_asa",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Copy data part 2",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "SqlDWSink",
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": false
								},
								"disableMetricsCollection": false
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "asastore01",
									"type": "LinkedServiceReference"
								},
								"path": "staging"
							},
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "City Key",
											"type": "String"
										},
										"sink": {
											"name": "CityKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Customer Key",
											"type": "String"
										},
										"sink": {
											"name": "CustomerKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Bill To Customer Key",
											"type": "Int32"
										},
										"sink": {
											"name": "BillToCustomerKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Stock Item Key",
											"type": "Int32"
										},
										"sink": {
											"name": "StockItemKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Invoice Date Key",
											"type": "DateTime"
										},
										"sink": {
											"name": "InvoiceDateKey",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "Delivery Date Key",
											"type": "DateTime"
										},
										"sink": {
											"name": "DeliveryDateKey",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "Salesperson Key",
											"type": "Int32"
										},
										"sink": {
											"name": "SalespersonKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "WWI Invoice ID",
											"type": "Int32"
										},
										"sink": {
											"name": "WWIInvoiceID",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Description",
											"type": "String"
										},
										"sink": {
											"name": "Description",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Package",
											"type": "String"
										},
										"sink": {
											"name": "Package",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Quantity",
											"type": "Decimal"
										},
										"sink": {
											"name": "Quantity",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Unit Price",
											"type": "Decimal"
										},
										"sink": {
											"name": "UnitPrice",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "Tax Rate",
											"type": "Decimal"
										},
										"sink": {
											"name": "TaxRate",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "Total Excluding Tax",
											"type": "Decimal"
										},
										"sink": {
											"name": "TotalExcludingTax",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "Tax Amount",
											"type": "Decimal"
										},
										"sink": {
											"name": "TaxAmount",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "Profit",
											"type": "Decimal"
										},
										"sink": {
											"name": "Profit",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "Total Including Tax",
											"type": "Decimal"
										},
										"sink": {
											"name": "TotalIncludingTax",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "Total Dry Items",
											"type": "Int32"
										},
										"sink": {
											"name": "TotalDryItems",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Total Chiller Items",
											"type": "Int32"
										},
										"sink": {
											"name": "TotalChillerItems",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Lineage Key",
											"type": "Int32"
										},
										"sink": {
											"name": "LineageKey",
											"type": "Int32"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "wwi_factsale_big_2_adls",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "wwi_perf_factsale_fast_asa",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Copy data part 4",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "SqlDWSink",
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": false
								},
								"disableMetricsCollection": false
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "asastore01",
									"type": "LinkedServiceReference"
								},
								"path": "staging"
							},
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "City Key",
											"type": "String"
										},
										"sink": {
											"name": "CityKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Customer Key",
											"type": "String"
										},
										"sink": {
											"name": "CustomerKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Bill To Customer Key",
											"type": "Int32"
										},
										"sink": {
											"name": "BillToCustomerKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Stock Item Key",
											"type": "Int32"
										},
										"sink": {
											"name": "StockItemKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Invoice Date Key",
											"type": "DateTime"
										},
										"sink": {
											"name": "InvoiceDateKey",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "Delivery Date Key",
											"type": "DateTime"
										},
										"sink": {
											"name": "DeliveryDateKey",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "Salesperson Key",
											"type": "Int32"
										},
										"sink": {
											"name": "SalespersonKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "WWI Invoice ID",
											"type": "Int32"
										},
										"sink": {
											"name": "WWIInvoiceID",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Description",
											"type": "String"
										},
										"sink": {
											"name": "Description",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Package",
											"type": "String"
										},
										"sink": {
											"name": "Package",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Quantity",
											"type": "Decimal"
										},
										"sink": {
											"name": "Quantity",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Unit Price",
											"type": "Decimal"
										},
										"sink": {
											"name": "UnitPrice",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "Tax Rate",
											"type": "Decimal"
										},
										"sink": {
											"name": "TaxRate",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "Total Excluding Tax",
											"type": "Decimal"
										},
										"sink": {
											"name": "TotalExcludingTax",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "Tax Amount",
											"type": "Decimal"
										},
										"sink": {
											"name": "TaxAmount",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "Profit",
											"type": "Decimal"
										},
										"sink": {
											"name": "Profit",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "Total Including Tax",
											"type": "Decimal"
										},
										"sink": {
											"name": "TotalIncludingTax",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "Total Dry Items",
											"type": "Int32"
										},
										"sink": {
											"name": "TotalDryItems",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Total Chiller Items",
											"type": "Int32"
										},
										"sink": {
											"name": "TotalChillerItems",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Lineage Key",
											"type": "Int32"
										},
										"sink": {
											"name": "LineageKey",
											"type": "Int32"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "wwi_factsale_big_4_adls",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "wwi_perf_factsale_fast_asa",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Copy data part 3",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "SqlDWSink",
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": false
								},
								"disableMetricsCollection": false
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "asastore01",
									"type": "LinkedServiceReference"
								},
								"path": "staging"
							},
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "City Key",
											"type": "String"
										},
										"sink": {
											"name": "CityKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Customer Key",
											"type": "String"
										},
										"sink": {
											"name": "CustomerKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Bill To Customer Key",
											"type": "Int32"
										},
										"sink": {
											"name": "BillToCustomerKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Stock Item Key",
											"type": "Int32"
										},
										"sink": {
											"name": "StockItemKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Invoice Date Key",
											"type": "DateTime"
										},
										"sink": {
											"name": "InvoiceDateKey",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "Delivery Date Key",
											"type": "DateTime"
										},
										"sink": {
											"name": "DeliveryDateKey",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "Salesperson Key",
											"type": "Int32"
										},
										"sink": {
											"name": "SalespersonKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "WWI Invoice ID",
											"type": "Int32"
										},
										"sink": {
											"name": "WWIInvoiceID",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Description",
											"type": "String"
										},
										"sink": {
											"name": "Description",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Package",
											"type": "String"
										},
										"sink": {
											"name": "Package",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Quantity",
											"type": "Decimal"
										},
										"sink": {
											"name": "Quantity",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Unit Price",
											"type": "Decimal"
										},
										"sink": {
											"name": "UnitPrice",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "Tax Rate",
											"type": "Decimal"
										},
										"sink": {
											"name": "TaxRate",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "Total Excluding Tax",
											"type": "Decimal"
										},
										"sink": {
											"name": "TotalExcludingTax",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "Tax Amount",
											"type": "Decimal"
										},
										"sink": {
											"name": "TaxAmount",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "Profit",
											"type": "Decimal"
										},
										"sink": {
											"name": "Profit",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "Total Including Tax",
											"type": "Decimal"
										},
										"sink": {
											"name": "TotalIncludingTax",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "Total Dry Items",
											"type": "Int32"
										},
										"sink": {
											"name": "TotalDryItems",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Total Chiller Items",
											"type": "Int32"
										},
										"sink": {
											"name": "TotalChillerItems",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Lineage Key",
											"type": "Int32"
										},
										"sink": {
											"name": "LineageKey",
											"type": "Int32"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "wwi_factsale_big_3_adls",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "wwi_perf_factsale_fast_asa",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"annotations": [],
				"lastPublishTime": "2021-06-02T10:09:01Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/datasets/wwi_factsale_big_1_adls')]",
				"[concat(variables('workspaceId'), '/datasets/wwi_perf_factsale_fast_asa')]",
				"[concat(variables('workspaceId'), '/datasets/wwi_factsale_big_2_adls')]",
				"[concat(variables('workspaceId'), '/datasets/wwi_factsale_big_4_adls')]",
				"[concat(variables('workspaceId'), '/datasets/wwi_factsale_big_3_adls')]",
				"[concat(variables('workspaceId'), '/linkedServices/asastore01')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Import WWI Perf Data - Fact Sale Slow')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "Copy data part 1",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "SqlDWSink",
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": false
								},
								"disableMetricsCollection": false
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "asastore01",
									"type": "LinkedServiceReference"
								},
								"path": "staging"
							},
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "City Key",
											"type": "String"
										},
										"sink": {
											"name": "CityKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Customer Key",
											"type": "String"
										},
										"sink": {
											"name": "CustomerKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Bill To Customer Key",
											"type": "Int32"
										},
										"sink": {
											"name": "BillToCustomerKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Stock Item Key",
											"type": "Int32"
										},
										"sink": {
											"name": "StockItemKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Invoice Date Key",
											"type": "DateTime"
										},
										"sink": {
											"name": "InvoiceDateKey",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "Delivery Date Key",
											"type": "DateTime"
										},
										"sink": {
											"name": "DeliveryDateKey",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "Salesperson Key",
											"type": "Int32"
										},
										"sink": {
											"name": "SalespersonKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "WWI Invoice ID",
											"type": "Int32"
										},
										"sink": {
											"name": "WWIInvoiceID",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Description",
											"type": "String"
										},
										"sink": {
											"name": "Description",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Package",
											"type": "String"
										},
										"sink": {
											"name": "Package",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Quantity",
											"type": "Decimal"
										},
										"sink": {
											"name": "Quantity",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Unit Price",
											"type": "Decimal"
										},
										"sink": {
											"name": "UnitPrice",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "Tax Rate",
											"type": "Decimal"
										},
										"sink": {
											"name": "TaxRate",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "Total Excluding Tax",
											"type": "Decimal"
										},
										"sink": {
											"name": "TotalExcludingTax",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "Tax Amount",
											"type": "Decimal"
										},
										"sink": {
											"name": "TaxAmount",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "Profit",
											"type": "Decimal"
										},
										"sink": {
											"name": "Profit",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "Total Including Tax",
											"type": "Decimal"
										},
										"sink": {
											"name": "TotalIncludingTax",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "Total Dry Items",
											"type": "Int32"
										},
										"sink": {
											"name": "TotalDryItems",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Total Chiller Items",
											"type": "Int32"
										},
										"sink": {
											"name": "TotalChillerItems",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Lineage Key",
											"type": "Int32"
										},
										"sink": {
											"name": "LineageKey",
											"type": "Int32"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "wwi_factsale_big_1_adls",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "wwi_perf_factsale_slow_asa",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Copy data part 2",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "SqlDWSink",
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": false
								},
								"disableMetricsCollection": false
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "asastore01",
									"type": "LinkedServiceReference"
								},
								"path": "staging"
							},
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "City Key",
											"type": "String"
										},
										"sink": {
											"name": "CityKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Customer Key",
											"type": "String"
										},
										"sink": {
											"name": "CustomerKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Bill To Customer Key",
											"type": "Int32"
										},
										"sink": {
											"name": "BillToCustomerKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Stock Item Key",
											"type": "Int32"
										},
										"sink": {
											"name": "StockItemKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Invoice Date Key",
											"type": "DateTime"
										},
										"sink": {
											"name": "InvoiceDateKey",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "Delivery Date Key",
											"type": "DateTime"
										},
										"sink": {
											"name": "DeliveryDateKey",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "Salesperson Key",
											"type": "Int32"
										},
										"sink": {
											"name": "SalespersonKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "WWI Invoice ID",
											"type": "Int32"
										},
										"sink": {
											"name": "WWIInvoiceID",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Description",
											"type": "String"
										},
										"sink": {
											"name": "Description",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Package",
											"type": "String"
										},
										"sink": {
											"name": "Package",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Quantity",
											"type": "Decimal"
										},
										"sink": {
											"name": "Quantity",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Unit Price",
											"type": "Decimal"
										},
										"sink": {
											"name": "UnitPrice",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "Tax Rate",
											"type": "Decimal"
										},
										"sink": {
											"name": "TaxRate",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "Total Excluding Tax",
											"type": "Decimal"
										},
										"sink": {
											"name": "TotalExcludingTax",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "Tax Amount",
											"type": "Decimal"
										},
										"sink": {
											"name": "TaxAmount",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "Profit",
											"type": "Decimal"
										},
										"sink": {
											"name": "Profit",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "Total Including Tax",
											"type": "Decimal"
										},
										"sink": {
											"name": "TotalIncludingTax",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "Total Dry Items",
											"type": "Int32"
										},
										"sink": {
											"name": "TotalDryItems",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Total Chiller Items",
											"type": "Int32"
										},
										"sink": {
											"name": "TotalChillerItems",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Lineage Key",
											"type": "Int32"
										},
										"sink": {
											"name": "LineageKey",
											"type": "Int32"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "wwi_factsale_big_2_adls",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "wwi_perf_factsale_slow_asa",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Copy data part 4",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "SqlDWSink",
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": false
								},
								"disableMetricsCollection": false
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "asastore01",
									"type": "LinkedServiceReference"
								},
								"path": "staging"
							},
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "City Key",
											"type": "String"
										},
										"sink": {
											"name": "CityKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Customer Key",
											"type": "String"
										},
										"sink": {
											"name": "CustomerKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Bill To Customer Key",
											"type": "Int32"
										},
										"sink": {
											"name": "BillToCustomerKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Stock Item Key",
											"type": "Int32"
										},
										"sink": {
											"name": "StockItemKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Invoice Date Key",
											"type": "DateTime"
										},
										"sink": {
											"name": "InvoiceDateKey",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "Delivery Date Key",
											"type": "DateTime"
										},
										"sink": {
											"name": "DeliveryDateKey",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "Salesperson Key",
											"type": "Int32"
										},
										"sink": {
											"name": "SalespersonKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "WWI Invoice ID",
											"type": "Int32"
										},
										"sink": {
											"name": "WWIInvoiceID",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Description",
											"type": "String"
										},
										"sink": {
											"name": "Description",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Package",
											"type": "String"
										},
										"sink": {
											"name": "Package",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Quantity",
											"type": "Decimal"
										},
										"sink": {
											"name": "Quantity",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Unit Price",
											"type": "Decimal"
										},
										"sink": {
											"name": "UnitPrice",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "Tax Rate",
											"type": "Decimal"
										},
										"sink": {
											"name": "TaxRate",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "Total Excluding Tax",
											"type": "Decimal"
										},
										"sink": {
											"name": "TotalExcludingTax",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "Tax Amount",
											"type": "Decimal"
										},
										"sink": {
											"name": "TaxAmount",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "Profit",
											"type": "Decimal"
										},
										"sink": {
											"name": "Profit",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "Total Including Tax",
											"type": "Decimal"
										},
										"sink": {
											"name": "TotalIncludingTax",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "Total Dry Items",
											"type": "Int32"
										},
										"sink": {
											"name": "TotalDryItems",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Total Chiller Items",
											"type": "Int32"
										},
										"sink": {
											"name": "TotalChillerItems",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Lineage Key",
											"type": "Int32"
										},
										"sink": {
											"name": "LineageKey",
											"type": "Int32"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "wwi_factsale_big_4_adls",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "wwi_perf_factsale_slow_asa",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Copy data part 3",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "SqlDWSink",
								"allowPolyBase": true,
								"polyBaseSettings": {
									"rejectValue": 0,
									"rejectType": "value",
									"useTypeDefault": false
								},
								"disableMetricsCollection": false
							},
							"enableStaging": true,
							"stagingSettings": {
								"linkedServiceName": {
									"referenceName": "asastore01",
									"type": "LinkedServiceReference"
								},
								"path": "staging"
							},
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "City Key",
											"type": "String"
										},
										"sink": {
											"name": "CityKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Customer Key",
											"type": "String"
										},
										"sink": {
											"name": "CustomerKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Bill To Customer Key",
											"type": "Int32"
										},
										"sink": {
											"name": "BillToCustomerKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Stock Item Key",
											"type": "Int32"
										},
										"sink": {
											"name": "StockItemKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Invoice Date Key",
											"type": "DateTime"
										},
										"sink": {
											"name": "InvoiceDateKey",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "Delivery Date Key",
											"type": "DateTime"
										},
										"sink": {
											"name": "DeliveryDateKey",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"name": "Salesperson Key",
											"type": "Int32"
										},
										"sink": {
											"name": "SalespersonKey",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "WWI Invoice ID",
											"type": "Int32"
										},
										"sink": {
											"name": "WWIInvoiceID",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Description",
											"type": "String"
										},
										"sink": {
											"name": "Description",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Package",
											"type": "String"
										},
										"sink": {
											"name": "Package",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Quantity",
											"type": "Decimal"
										},
										"sink": {
											"name": "Quantity",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Unit Price",
											"type": "Decimal"
										},
										"sink": {
											"name": "UnitPrice",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "Tax Rate",
											"type": "Decimal"
										},
										"sink": {
											"name": "TaxRate",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "Total Excluding Tax",
											"type": "Decimal"
										},
										"sink": {
											"name": "TotalExcludingTax",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "Tax Amount",
											"type": "Decimal"
										},
										"sink": {
											"name": "TaxAmount",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "Profit",
											"type": "Decimal"
										},
										"sink": {
											"name": "Profit",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "Total Including Tax",
											"type": "Decimal"
										},
										"sink": {
											"name": "TotalIncludingTax",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"name": "Total Dry Items",
											"type": "Int32"
										},
										"sink": {
											"name": "TotalDryItems",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Total Chiller Items",
											"type": "Int32"
										},
										"sink": {
											"name": "TotalChillerItems",
											"type": "Int32"
										}
									},
									{
										"source": {
											"name": "Lineage Key",
											"type": "Int32"
										},
										"sink": {
											"name": "LineageKey",
											"type": "Int32"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "wwi_factsale_big_3_adls",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "wwi_perf_factsale_slow_asa",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"annotations": [],
				"lastPublishTime": "2021-06-02T10:09:05Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/datasets/wwi_factsale_big_1_adls')]",
				"[concat(variables('workspaceId'), '/datasets/wwi_perf_factsale_slow_asa')]",
				"[concat(variables('workspaceId'), '/datasets/wwi_factsale_big_2_adls')]",
				"[concat(variables('workspaceId'), '/datasets/wwi_factsale_big_4_adls')]",
				"[concat(variables('workspaceId'), '/datasets/wwi_factsale_big_3_adls')]",
				"[concat(variables('workspaceId'), '/linkedServices/asastore01')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/external_postalcode_adls')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "asadatalake01",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": "postalcodes.csv",
						"folderPath": "bronze",
						"fileSystem": "dev"
					},
					"columnDelimiter": ",",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": [
					{
						"name": "City",
						"type": "String"
					},
					{
						"name": "State",
						"type": "String"
					},
					{
						"name": "Zip",
						"type": "String"
					},
					{
						"name": "Latitude",
						"type": "String"
					},
					{
						"name": "Longitude",
						"type": "String"
					},
					{
						"name": "Timezone",
						"type": "String"
					},
					{
						"name": "DST",
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/asadatalake01')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/staging_enrichedcustomer_adls')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "asadatalake01",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "Parquet",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"folderPath": "customer",
						"fileSystem": "staging"
					},
					"compressionCodec": "snappy"
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/asadatalake01')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/wwi_dimcity_adls')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "asadatalake01",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": "wwi-dimcity.csv",
						"folderPath": "bronze",
						"fileSystem": "dev"
					},
					"columnDelimiter": "|",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": ""
				},
				"schema": [
					{
						"name": "City Key",
						"type": "String"
					},
					{
						"name": "WWI City ID",
						"type": "String"
					},
					{
						"name": "City",
						"type": "String"
					},
					{
						"name": "State Province",
						"type": "String"
					},
					{
						"name": "Country",
						"type": "String"
					},
					{
						"name": "Continent",
						"type": "String"
					},
					{
						"name": "Sales Territory",
						"type": "String"
					},
					{
						"name": "Region",
						"type": "String"
					},
					{
						"name": "Subregion",
						"type": "String"
					},
					{
						"name": "Latest Recorded Population",
						"type": "String"
					},
					{
						"name": "Valid From",
						"type": "String"
					},
					{
						"name": "Valid To",
						"type": "String"
					},
					{
						"name": "Lineage Key",
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/asadatalake01')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/wwi_dimcity_asa')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "sqlpool01",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlDWTable",
				"schema": [
					{
						"name": "CityKey",
						"type": "int",
						"precision": 10
					},
					{
						"name": "WWICityID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "City",
						"type": "nvarchar"
					},
					{
						"name": "StateProvince",
						"type": "nvarchar"
					},
					{
						"name": "Country",
						"type": "nvarchar"
					},
					{
						"name": "Continent",
						"type": "nvarchar"
					},
					{
						"name": "SalesTerritory",
						"type": "nvarchar"
					},
					{
						"name": "Region",
						"type": "nvarchar"
					},
					{
						"name": "Subregion",
						"type": "nvarchar"
					},
					{
						"name": "LatestRecordedPopulation",
						"type": "bigint",
						"precision": 19
					},
					{
						"name": "ValidFrom",
						"type": "datetime2",
						"scale": 7
					},
					{
						"name": "ValidTo",
						"type": "datetime2",
						"scale": 7
					},
					{
						"name": "LineageKey",
						"type": "int",
						"precision": 10
					}
				],
				"typeProperties": {
					"schema": "wwi",
					"table": "DimCity"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/sqlpool01')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/wwi_dimcustomer_adls')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "asadatalake01",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": "wwi-dimcustomer.csv",
						"folderPath": "bronze",
						"fileSystem": "dev"
					},
					"columnDelimiter": "|",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": ""
				},
				"schema": [
					{
						"name": "Customer Key",
						"type": "String"
					},
					{
						"name": "WWI Customer ID",
						"type": "String"
					},
					{
						"name": "Customer",
						"type": "String"
					},
					{
						"name": "Bill To Customer",
						"type": "String"
					},
					{
						"name": "Category",
						"type": "String"
					},
					{
						"name": "Buying Group",
						"type": "String"
					},
					{
						"name": "Primary Contact",
						"type": "String"
					},
					{
						"name": "Postal Code",
						"type": "String"
					},
					{
						"name": "Valid From",
						"type": "String"
					},
					{
						"name": "Valid To",
						"type": "String"
					},
					{
						"name": "Lineage Key",
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/asadatalake01')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/wwi_dimcustomer_asa')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "sqlpool01",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlDWTable",
				"schema": [
					{
						"name": "CustomerKey",
						"type": "int",
						"precision": 10
					},
					{
						"name": "WWICustomerID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Customer",
						"type": "nvarchar"
					},
					{
						"name": "BillToCustomer",
						"type": "nvarchar"
					},
					{
						"name": "Category",
						"type": "nvarchar"
					},
					{
						"name": "BuyingGroup",
						"type": "nvarchar"
					},
					{
						"name": "PrimaryContact",
						"type": "nvarchar"
					},
					{
						"name": "PostalCode",
						"type": "nvarchar"
					},
					{
						"name": "ValidFrom",
						"type": "datetime2",
						"scale": 7
					},
					{
						"name": "ValidTo",
						"type": "datetime2",
						"scale": 7
					},
					{
						"name": "LineageKey",
						"type": "int",
						"precision": 10
					}
				],
				"typeProperties": {
					"schema": "wwi",
					"table": "DimCustomer"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/sqlpool01')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/wwi_dimdate_adls')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "asadatalake01",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": "wwi-dimdate.csv",
						"folderPath": "bronze",
						"fileSystem": "dev"
					},
					"columnDelimiter": "|",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": ""
				},
				"schema": [
					{
						"name": "Date",
						"type": "String"
					},
					{
						"name": "Day Number",
						"type": "String"
					},
					{
						"name": "Day",
						"type": "String"
					},
					{
						"name": "Month",
						"type": "String"
					},
					{
						"name": "Short Month",
						"type": "String"
					},
					{
						"name": "Calendar Month Number",
						"type": "String"
					},
					{
						"name": "Calendar Month Label",
						"type": "String"
					},
					{
						"name": "Calendar Year",
						"type": "String"
					},
					{
						"name": "Calendar Year Label",
						"type": "String"
					},
					{
						"name": "Fiscal Month Number",
						"type": "String"
					},
					{
						"name": "Fiscal Month Label",
						"type": "String"
					},
					{
						"name": "Fiscal Year",
						"type": "String"
					},
					{
						"name": "Fiscal Year Label",
						"type": "String"
					},
					{
						"name": "ISO Week Number",
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/asadatalake01')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/wwi_dimdate_asa')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "sqlpool01",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlDWTable",
				"schema": [
					{
						"name": "Date",
						"type": "date"
					},
					{
						"name": "DayNumber",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Day",
						"type": "nvarchar"
					},
					{
						"name": "Month",
						"type": "nvarchar"
					},
					{
						"name": "ShortMonth",
						"type": "nvarchar"
					},
					{
						"name": "CalendarMonthNumber",
						"type": "int",
						"precision": 10
					},
					{
						"name": "CalendarMonthLabel",
						"type": "nvarchar"
					},
					{
						"name": "CalendarYear",
						"type": "int",
						"precision": 10
					},
					{
						"name": "CalendarYearLabel",
						"type": "nvarchar"
					},
					{
						"name": "FiscalMonthNumber",
						"type": "int",
						"precision": 10
					},
					{
						"name": "FiscalMonthLabel",
						"type": "nvarchar"
					},
					{
						"name": "FiscalYear",
						"type": "int",
						"precision": 10
					},
					{
						"name": "FiscalYearLabel",
						"type": "nvarchar"
					},
					{
						"name": "ISOWeekNumber",
						"type": "int",
						"precision": 10
					}
				],
				"typeProperties": {
					"schema": "wwi",
					"table": "DimDate"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/sqlpool01')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/wwi_dimemployee_adls')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "asadatalake01",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": "wwi-dimemployee.csv",
						"folderPath": "bronze",
						"fileSystem": "dev"
					},
					"columnDelimiter": "|",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": ""
				},
				"schema": [
					{
						"name": "Employee Key",
						"type": "String"
					},
					{
						"name": "WWI Employee ID",
						"type": "String"
					},
					{
						"name": "Employee",
						"type": "String"
					},
					{
						"name": "Preferred Name",
						"type": "String"
					},
					{
						"name": "Is Salesperson",
						"type": "String"
					},
					{
						"name": "Valid From",
						"type": "String"
					},
					{
						"name": "Valid To",
						"type": "String"
					},
					{
						"name": "Lineage Key",
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/asadatalake01')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/wwi_dimemployee_asa')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "sqlpool01",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlDWTable",
				"schema": [
					{
						"name": "EmployeeKey",
						"type": "int",
						"precision": 10
					},
					{
						"name": "WWIEmployeeID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Employee",
						"type": "nvarchar"
					},
					{
						"name": "PreferredName",
						"type": "nvarchar"
					},
					{
						"name": "IsSalesperson",
						"type": "bit"
					},
					{
						"name": "ValidFrom",
						"type": "datetime2",
						"scale": 7
					},
					{
						"name": "ValidTo",
						"type": "datetime2",
						"scale": 7
					},
					{
						"name": "LineageKey",
						"type": "int",
						"precision": 10
					}
				],
				"typeProperties": {
					"schema": "wwi",
					"table": "DimEmployee"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/sqlpool01')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/wwi_dimpaymentmethod_adls')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "asadatalake01",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": "wwi-dimpaymentmethod.csv",
						"folderPath": "bronze",
						"fileSystem": "dev"
					},
					"columnDelimiter": "|",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": ""
				},
				"schema": [
					{
						"name": "Payment Method Key",
						"type": "String"
					},
					{
						"name": "WWI Payment Method ID",
						"type": "String"
					},
					{
						"name": "Payment Method",
						"type": "String"
					},
					{
						"name": "Valid From",
						"type": "String"
					},
					{
						"name": "Valid To",
						"type": "String"
					},
					{
						"name": "Lineage Key",
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/asadatalake01')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/wwi_dimpaymentmethod_asa')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "sqlpool01",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlDWTable",
				"schema": [
					{
						"name": "PaymentMethodKey",
						"type": "int",
						"precision": 10
					},
					{
						"name": "WWIPaymentMethodID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "PaymentMethod",
						"type": "nvarchar"
					},
					{
						"name": "ValidFrom",
						"type": "datetime2",
						"scale": 7
					},
					{
						"name": "ValidTo",
						"type": "datetime2",
						"scale": 7
					},
					{
						"name": "LineageKey",
						"type": "int",
						"precision": 10
					}
				],
				"typeProperties": {
					"schema": "wwi",
					"table": "DimPaymentMethod"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/sqlpool01')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/wwi_dimstockitem_adls')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "asadatalake01",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": "wwi-dimstockitem.csv",
						"folderPath": "bronze",
						"fileSystem": "dev"
					},
					"columnDelimiter": "|",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": ""
				},
				"schema": [
					{
						"name": "Stock Item Key",
						"type": "String"
					},
					{
						"name": "WWI Stock Item ID",
						"type": "String"
					},
					{
						"name": "Stock Item",
						"type": "String"
					},
					{
						"name": "Color",
						"type": "String"
					},
					{
						"name": "Selling Package",
						"type": "String"
					},
					{
						"name": "Buying Package",
						"type": "String"
					},
					{
						"name": "Brand",
						"type": "String"
					},
					{
						"name": "Size",
						"type": "String"
					},
					{
						"name": "Lead Time Days",
						"type": "String"
					},
					{
						"name": "Quantity Per Outer",
						"type": "String"
					},
					{
						"name": "Is Chiller Stock",
						"type": "String"
					},
					{
						"name": "Barcode",
						"type": "String"
					},
					{
						"name": "Tax Rate",
						"type": "String"
					},
					{
						"name": "Unit Price",
						"type": "String"
					},
					{
						"name": "Recommended Retail Price",
						"type": "String"
					},
					{
						"name": "Typical Weight Per Unit",
						"type": "String"
					},
					{
						"name": "Valid From",
						"type": "String"
					},
					{
						"name": "Valid To",
						"type": "String"
					},
					{
						"name": "Lineage Key",
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/asadatalake01')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/wwi_dimstockitem_asa')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "sqlpool01",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlDWTable",
				"schema": [
					{
						"name": "StockItemKey",
						"type": "int",
						"precision": 10
					},
					{
						"name": "WWIStockItemID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Stock Item",
						"type": "nvarchar"
					},
					{
						"name": "Color",
						"type": "nvarchar"
					},
					{
						"name": "SellingPackage",
						"type": "nvarchar"
					},
					{
						"name": "Buying Package",
						"type": "nvarchar"
					},
					{
						"name": "Brand",
						"type": "nvarchar"
					},
					{
						"name": "Size",
						"type": "nvarchar"
					},
					{
						"name": "LeadTimeDays",
						"type": "int",
						"precision": 10
					},
					{
						"name": "QuantityPerOuter",
						"type": "int",
						"precision": 10
					},
					{
						"name": "IsChillerStock",
						"type": "bit"
					},
					{
						"name": "Barcode",
						"type": "nvarchar"
					},
					{
						"name": "TaxRate",
						"type": "decimal",
						"precision": 18,
						"scale": 3
					},
					{
						"name": "UnitPrice",
						"type": "decimal",
						"precision": 18,
						"scale": 2
					},
					{
						"name": "RecommendedRetailPrice",
						"type": "decimal",
						"precision": 18,
						"scale": 2
					},
					{
						"name": "TypicalWeightPerUnit",
						"type": "decimal",
						"precision": 18,
						"scale": 3
					},
					{
						"name": "ValidFrom",
						"type": "datetime2",
						"scale": 7
					},
					{
						"name": "ValidTo",
						"type": "datetime2",
						"scale": 7
					},
					{
						"name": "LineageKey",
						"type": "int",
						"precision": 10
					}
				],
				"typeProperties": {
					"schema": "wwi",
					"table": "DimStockItem"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/sqlpool01')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/wwi_dimsupplier_adls')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "asadatalake01",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": "wwi-dimsupplier.csv",
						"folderPath": "bronze",
						"fileSystem": "dev"
					},
					"columnDelimiter": "|",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": ""
				},
				"schema": [
					{
						"name": "Supplier Key",
						"type": "String"
					},
					{
						"name": "WWI Supplier ID",
						"type": "String"
					},
					{
						"name": "Supplier",
						"type": "String"
					},
					{
						"name": "Category",
						"type": "String"
					},
					{
						"name": "Primary Contact",
						"type": "String"
					},
					{
						"name": "Supplier Reference",
						"type": "String"
					},
					{
						"name": "Payment Days",
						"type": "String"
					},
					{
						"name": "Postal Code",
						"type": "String"
					},
					{
						"name": "Valid From",
						"type": "String"
					},
					{
						"name": "Valid To",
						"type": "String"
					},
					{
						"name": "Lineage Key",
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/asadatalake01')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/wwi_dimsupplier_asa')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "sqlpool01",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlDWTable",
				"schema": [
					{
						"name": "SupplierKey",
						"type": "int",
						"precision": 10
					},
					{
						"name": "WWISupplierID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Supplier",
						"type": "nvarchar"
					},
					{
						"name": "Category",
						"type": "nvarchar"
					},
					{
						"name": "PrimaryContact",
						"type": "nvarchar"
					},
					{
						"name": "SupplierReference",
						"type": "nvarchar"
					},
					{
						"name": "PaymentDays",
						"type": "int",
						"precision": 10
					},
					{
						"name": "PostalCode",
						"type": "nvarchar"
					},
					{
						"name": "ValidFrom",
						"type": "datetime2",
						"scale": 7
					},
					{
						"name": "ValidTo",
						"type": "datetime2",
						"scale": 7
					},
					{
						"name": "LineageKey",
						"type": "int",
						"precision": 10
					}
				],
				"typeProperties": {
					"schema": "wwi",
					"table": "DimSupplier"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/sqlpool01')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/wwi_dimtransactiontype_adls')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "asadatalake01",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": "wwi-dimtransactiontype.csv",
						"folderPath": "bronze",
						"fileSystem": "dev"
					},
					"columnDelimiter": "|",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": ""
				},
				"schema": [
					{
						"name": "Transaction Type Key",
						"type": "String"
					},
					{
						"name": "WWI Transaction Type ID",
						"type": "String"
					},
					{
						"name": "Transaction Type",
						"type": "String"
					},
					{
						"name": "Valid From",
						"type": "String"
					},
					{
						"name": "Valid To",
						"type": "String"
					},
					{
						"name": "Lineage Key",
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/asadatalake01')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/wwi_dimtransactiontype_asa')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "sqlpool01",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlDWTable",
				"schema": [
					{
						"name": "TransactionTypeKey",
						"type": "int",
						"precision": 10
					},
					{
						"name": "WWITransactionTypeID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "TransactionType",
						"type": "nvarchar"
					},
					{
						"name": "ValidFrom",
						"type": "datetime2",
						"scale": 7
					},
					{
						"name": "ValidTo",
						"type": "datetime2",
						"scale": 7
					},
					{
						"name": "LineageKey",
						"type": "int",
						"precision": 10
					}
				],
				"typeProperties": {
					"schema": "wwi",
					"table": "DimTransactionType"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/sqlpool01')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/wwi_factmovement_adls')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "asadatalake01",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": "wwi-factmovement.csv",
						"folderPath": "bronze",
						"fileSystem": "dev"
					},
					"columnDelimiter": "|",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": ""
				},
				"schema": [
					{
						"name": "Movement Key",
						"type": "String"
					},
					{
						"name": "Date Key",
						"type": "String"
					},
					{
						"name": "Stock Item Key",
						"type": "String"
					},
					{
						"name": "Customer Key",
						"type": "String"
					},
					{
						"name": "Supplier Key",
						"type": "String"
					},
					{
						"name": "Transaction Type Key",
						"type": "String"
					},
					{
						"name": "WWI Stock Item Transaction ID",
						"type": "String"
					},
					{
						"name": "WWI Invoice ID",
						"type": "String"
					},
					{
						"name": "WWI Purchase Order ID",
						"type": "String"
					},
					{
						"name": "Quantity",
						"type": "String"
					},
					{
						"name": "Lineage Key",
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/asadatalake01')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/wwi_factmovement_asa')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "sqlpool01",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlDWTable",
				"schema": [
					{
						"name": "MovementKey",
						"type": "bigint",
						"precision": 19
					},
					{
						"name": "DateKey",
						"type": "date"
					},
					{
						"name": "StockItemKey",
						"type": "int",
						"precision": 10
					},
					{
						"name": "CustomerKey",
						"type": "int",
						"precision": 10
					},
					{
						"name": "SupplierKey",
						"type": "int",
						"precision": 10
					},
					{
						"name": "TransactionTypeKey",
						"type": "int",
						"precision": 10
					},
					{
						"name": "WWIStockItemTransactionID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "WWIInvoiceID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "WWIPurchaseOrderID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Quantity",
						"type": "int",
						"precision": 10
					},
					{
						"name": "LineageKey",
						"type": "int",
						"precision": 10
					}
				],
				"typeProperties": {
					"schema": "wwi",
					"table": "FactMovement"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/sqlpool01')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/wwi_factorder_adls')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "asadatalake01",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": "wwi-factorder.csv",
						"folderPath": "bronze",
						"fileSystem": "dev"
					},
					"columnDelimiter": "|",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": ""
				},
				"schema": [
					{
						"name": "Order Key",
						"type": "String"
					},
					{
						"name": "City Key",
						"type": "String"
					},
					{
						"name": "Customer Key",
						"type": "String"
					},
					{
						"name": "Stock Item Key",
						"type": "String"
					},
					{
						"name": "Order Date Key",
						"type": "String"
					},
					{
						"name": "Picked Date Key",
						"type": "String"
					},
					{
						"name": "Salesperson Key",
						"type": "String"
					},
					{
						"name": "Picker Key",
						"type": "String"
					},
					{
						"name": "WWI Order ID",
						"type": "String"
					},
					{
						"name": "WWI Backorder ID",
						"type": "String"
					},
					{
						"name": "Description",
						"type": "String"
					},
					{
						"name": "Package",
						"type": "String"
					},
					{
						"name": "Quantity",
						"type": "String"
					},
					{
						"name": "Unit Price",
						"type": "String"
					},
					{
						"name": "Tax Rate",
						"type": "String"
					},
					{
						"name": "Total Excluding Tax",
						"type": "String"
					},
					{
						"name": "Tax Amount",
						"type": "String"
					},
					{
						"name": "Total Including Tax",
						"type": "String"
					},
					{
						"name": "Lineage Key",
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/asadatalake01')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/wwi_factorder_asa')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "sqlpool01",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlDWTable",
				"schema": [
					{
						"name": "OrderKey",
						"type": "bigint",
						"precision": 19
					},
					{
						"name": "CityKey",
						"type": "int",
						"precision": 10
					},
					{
						"name": "CustomerKey",
						"type": "int",
						"precision": 10
					},
					{
						"name": "StockItemKey",
						"type": "int",
						"precision": 10
					},
					{
						"name": "OrderDateKey",
						"type": "date"
					},
					{
						"name": "PickedDateKey",
						"type": "date"
					},
					{
						"name": "SalespersonKey",
						"type": "int",
						"precision": 10
					},
					{
						"name": "PickerKey",
						"type": "int",
						"precision": 10
					},
					{
						"name": "WWIOrderID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "WWIBackorderID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Description",
						"type": "nvarchar"
					},
					{
						"name": "Package",
						"type": "nvarchar"
					},
					{
						"name": "Quantity",
						"type": "int",
						"precision": 10
					},
					{
						"name": "UnitPrice",
						"type": "decimal",
						"precision": 18,
						"scale": 2
					},
					{
						"name": "TaxRate",
						"type": "decimal",
						"precision": 18,
						"scale": 3
					},
					{
						"name": "TotalExcludingTax",
						"type": "decimal",
						"precision": 18,
						"scale": 2
					},
					{
						"name": "TaxAmount",
						"type": "decimal",
						"precision": 18,
						"scale": 2
					},
					{
						"name": "TotalIncludingTax",
						"type": "decimal",
						"precision": 18,
						"scale": 2
					},
					{
						"name": "LineageKey",
						"type": "int",
						"precision": 10
					}
				],
				"typeProperties": {
					"schema": "wwi",
					"table": "FactOrder"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/sqlpool01')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/wwi_factpurchase_adls')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "asadatalake01",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": "wwi-factpurchase.csv",
						"folderPath": "bronze",
						"fileSystem": "dev"
					},
					"columnDelimiter": "|",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": ""
				},
				"schema": [
					{
						"name": "Purchase Key",
						"type": "String"
					},
					{
						"name": "Date Key",
						"type": "String"
					},
					{
						"name": "Supplier Key",
						"type": "String"
					},
					{
						"name": "Stock Item Key",
						"type": "String"
					},
					{
						"name": "WWI Purchase Order ID",
						"type": "String"
					},
					{
						"name": "Ordered Outers",
						"type": "String"
					},
					{
						"name": "Ordered Quantity",
						"type": "String"
					},
					{
						"name": "Received Outers",
						"type": "String"
					},
					{
						"name": "Package",
						"type": "String"
					},
					{
						"name": "Is Order Finalized",
						"type": "String"
					},
					{
						"name": "Lineage Key",
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/asadatalake01')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/wwi_factpurchase_asa')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "sqlpool01",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlDWTable",
				"schema": [
					{
						"name": "PurchaseKey",
						"type": "bigint",
						"precision": 19
					},
					{
						"name": "DateKey",
						"type": "date"
					},
					{
						"name": "SupplierKey",
						"type": "int",
						"precision": 10
					},
					{
						"name": "StockItemKey",
						"type": "int",
						"precision": 10
					},
					{
						"name": "WWIPurchaseOrderID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "OrderedOuters",
						"type": "int",
						"precision": 10
					},
					{
						"name": "OrderedQuantity",
						"type": "int",
						"precision": 10
					},
					{
						"name": "ReceivedOuters",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Package",
						"type": "nvarchar"
					},
					{
						"name": "IsOrderFinalized",
						"type": "bit"
					},
					{
						"name": "LineageKey",
						"type": "int",
						"precision": 10
					}
				],
				"typeProperties": {
					"schema": "wwi",
					"table": "FactPurchase"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/sqlpool01')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/wwi_factsale_adls')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "asadatalake01",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": "wwi-factsale.csv",
						"folderPath": "bronze",
						"fileSystem": "dev"
					},
					"columnDelimiter": "|",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": ""
				},
				"schema": [
					{
						"name": "Sale Key",
						"type": "String"
					},
					{
						"name": "City Key",
						"type": "String"
					},
					{
						"name": "Customer Key",
						"type": "String"
					},
					{
						"name": "Bill To Customer Key",
						"type": "String"
					},
					{
						"name": "Stock Item Key",
						"type": "String"
					},
					{
						"name": "Invoice Date Key",
						"type": "String"
					},
					{
						"name": "Delivery Date Key",
						"type": "String"
					},
					{
						"name": "Salesperson Key",
						"type": "String"
					},
					{
						"name": "WWI Invoice ID",
						"type": "String"
					},
					{
						"name": "Description",
						"type": "String"
					},
					{
						"name": "Package",
						"type": "String"
					},
					{
						"name": "Quantity",
						"type": "String"
					},
					{
						"name": "Unit Price",
						"type": "String"
					},
					{
						"name": "Tax Rate",
						"type": "String"
					},
					{
						"name": "Total Excluding Tax",
						"type": "String"
					},
					{
						"name": "Tax Amount",
						"type": "String"
					},
					{
						"name": "Profit",
						"type": "String"
					},
					{
						"name": "Total Including Tax",
						"type": "String"
					},
					{
						"name": "Total Dry Items",
						"type": "String"
					},
					{
						"name": "Total Chiller Items",
						"type": "String"
					},
					{
						"name": "Lineage Key",
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/asadatalake01')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/wwi_factsale_asa')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "sqlpool01",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlDWTable",
				"schema": [
					{
						"name": "SaleKey",
						"type": "bigint",
						"precision": 19
					},
					{
						"name": "CityKey",
						"type": "int",
						"precision": 10
					},
					{
						"name": "CustomerKey",
						"type": "int",
						"precision": 10
					},
					{
						"name": "BillToCustomerKey",
						"type": "int",
						"precision": 10
					},
					{
						"name": "StockItemKey",
						"type": "int",
						"precision": 10
					},
					{
						"name": "InvoiceDateKey",
						"type": "date"
					},
					{
						"name": "DeliveryDateKey",
						"type": "date"
					},
					{
						"name": "SalespersonKey",
						"type": "int",
						"precision": 10
					},
					{
						"name": "WWIInvoiceID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Description",
						"type": "nvarchar"
					},
					{
						"name": "Package",
						"type": "nvarchar"
					},
					{
						"name": "Quantity",
						"type": "int",
						"precision": 10
					},
					{
						"name": "UnitPrice",
						"type": "decimal",
						"precision": 18,
						"scale": 2
					},
					{
						"name": "TaxRate",
						"type": "decimal",
						"precision": 18,
						"scale": 3
					},
					{
						"name": "TotalExcludingTax",
						"type": "decimal",
						"precision": 18,
						"scale": 2
					},
					{
						"name": "TaxAmount",
						"type": "decimal",
						"precision": 18,
						"scale": 2
					},
					{
						"name": "Profit",
						"type": "decimal",
						"precision": 18,
						"scale": 2
					},
					{
						"name": "TotalIncludingTax",
						"type": "decimal",
						"precision": 18,
						"scale": 2
					},
					{
						"name": "TotalDryItems",
						"type": "int",
						"precision": 10
					},
					{
						"name": "TotalChillerItems",
						"type": "int",
						"precision": 10
					},
					{
						"name": "LineageKey",
						"type": "int",
						"precision": 10
					}
				],
				"typeProperties": {
					"schema": "wwi",
					"table": "FactSale"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/sqlpool01')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/wwi_factsale_big_1_adls')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "asadatalake01",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": "wwi-factsale-big-1.csv",
						"folderPath": "bronze",
						"fileSystem": "dev"
					},
					"columnDelimiter": "|",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": ""
				},
				"schema": [
					{
						"name": "Sale Key",
						"type": "String"
					},
					{
						"name": "City Key",
						"type": "String"
					},
					{
						"name": "Customer Key",
						"type": "String"
					},
					{
						"name": "Bill To Customer Key",
						"type": "String"
					},
					{
						"name": "Stock Item Key",
						"type": "String"
					},
					{
						"name": "Invoice Date Key",
						"type": "String"
					},
					{
						"name": "Delivery Date Key",
						"type": "String"
					},
					{
						"name": "Salesperson Key",
						"type": "String"
					},
					{
						"name": "WWI Invoice ID",
						"type": "String"
					},
					{
						"name": "Description",
						"type": "String"
					},
					{
						"name": "Package",
						"type": "String"
					},
					{
						"name": "Quantity",
						"type": "String"
					},
					{
						"name": "Unit Price",
						"type": "String"
					},
					{
						"name": "Tax Rate",
						"type": "String"
					},
					{
						"name": "Total Excluding Tax",
						"type": "String"
					},
					{
						"name": "Tax Amount",
						"type": "String"
					},
					{
						"name": "Profit",
						"type": "String"
					},
					{
						"name": "Total Including Tax",
						"type": "String"
					},
					{
						"name": "Total Dry Items",
						"type": "String"
					},
					{
						"name": "Total Chiller Items",
						"type": "String"
					},
					{
						"name": "Lineage Key",
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/asadatalake01')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/wwi_factsale_big_2_adls')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "asadatalake01",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": "wwi-factsale-big-2.csv",
						"folderPath": "bronze",
						"fileSystem": "dev"
					},
					"columnDelimiter": "|",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": ""
				},
				"schema": [
					{
						"name": "Sale Key",
						"type": "String"
					},
					{
						"name": "City Key",
						"type": "String"
					},
					{
						"name": "Customer Key",
						"type": "String"
					},
					{
						"name": "Bill To Customer Key",
						"type": "String"
					},
					{
						"name": "Stock Item Key",
						"type": "String"
					},
					{
						"name": "Invoice Date Key",
						"type": "String"
					},
					{
						"name": "Delivery Date Key",
						"type": "String"
					},
					{
						"name": "Salesperson Key",
						"type": "String"
					},
					{
						"name": "WWI Invoice ID",
						"type": "String"
					},
					{
						"name": "Description",
						"type": "String"
					},
					{
						"name": "Package",
						"type": "String"
					},
					{
						"name": "Quantity",
						"type": "String"
					},
					{
						"name": "Unit Price",
						"type": "String"
					},
					{
						"name": "Tax Rate",
						"type": "String"
					},
					{
						"name": "Total Excluding Tax",
						"type": "String"
					},
					{
						"name": "Tax Amount",
						"type": "String"
					},
					{
						"name": "Profit",
						"type": "String"
					},
					{
						"name": "Total Including Tax",
						"type": "String"
					},
					{
						"name": "Total Dry Items",
						"type": "String"
					},
					{
						"name": "Total Chiller Items",
						"type": "String"
					},
					{
						"name": "Lineage Key",
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/asadatalake01')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/wwi_factsale_big_3_adls')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "asadatalake01",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": "wwi-factsale-big-3.csv",
						"folderPath": "bronze",
						"fileSystem": "dev"
					},
					"columnDelimiter": "|",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": ""
				},
				"schema": [
					{
						"name": "Sale Key",
						"type": "String"
					},
					{
						"name": "City Key",
						"type": "String"
					},
					{
						"name": "Customer Key",
						"type": "String"
					},
					{
						"name": "Bill To Customer Key",
						"type": "String"
					},
					{
						"name": "Stock Item Key",
						"type": "String"
					},
					{
						"name": "Invoice Date Key",
						"type": "String"
					},
					{
						"name": "Delivery Date Key",
						"type": "String"
					},
					{
						"name": "Salesperson Key",
						"type": "String"
					},
					{
						"name": "WWI Invoice ID",
						"type": "String"
					},
					{
						"name": "Description",
						"type": "String"
					},
					{
						"name": "Package",
						"type": "String"
					},
					{
						"name": "Quantity",
						"type": "String"
					},
					{
						"name": "Unit Price",
						"type": "String"
					},
					{
						"name": "Tax Rate",
						"type": "String"
					},
					{
						"name": "Total Excluding Tax",
						"type": "String"
					},
					{
						"name": "Tax Amount",
						"type": "String"
					},
					{
						"name": "Profit",
						"type": "String"
					},
					{
						"name": "Total Including Tax",
						"type": "String"
					},
					{
						"name": "Total Dry Items",
						"type": "String"
					},
					{
						"name": "Total Chiller Items",
						"type": "String"
					},
					{
						"name": "Lineage Key",
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/asadatalake01')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/wwi_factsale_big_4_adls')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "asadatalake01",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": "wwi-factsale-big-4.csv",
						"folderPath": "bronze",
						"fileSystem": "dev"
					},
					"columnDelimiter": "|",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": ""
				},
				"schema": [
					{
						"name": "Sale Key",
						"type": "String"
					},
					{
						"name": "City Key",
						"type": "String"
					},
					{
						"name": "Customer Key",
						"type": "String"
					},
					{
						"name": "Bill To Customer Key",
						"type": "String"
					},
					{
						"name": "Stock Item Key",
						"type": "String"
					},
					{
						"name": "Invoice Date Key",
						"type": "String"
					},
					{
						"name": "Delivery Date Key",
						"type": "String"
					},
					{
						"name": "Salesperson Key",
						"type": "String"
					},
					{
						"name": "WWI Invoice ID",
						"type": "String"
					},
					{
						"name": "Description",
						"type": "String"
					},
					{
						"name": "Package",
						"type": "String"
					},
					{
						"name": "Quantity",
						"type": "String"
					},
					{
						"name": "Unit Price",
						"type": "String"
					},
					{
						"name": "Tax Rate",
						"type": "String"
					},
					{
						"name": "Total Excluding Tax",
						"type": "String"
					},
					{
						"name": "Tax Amount",
						"type": "String"
					},
					{
						"name": "Profit",
						"type": "String"
					},
					{
						"name": "Total Including Tax",
						"type": "String"
					},
					{
						"name": "Total Dry Items",
						"type": "String"
					},
					{
						"name": "Total Chiller Items",
						"type": "String"
					},
					{
						"name": "Lineage Key",
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/asadatalake01')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/wwi_factstockholding_adls')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "asadatalake01",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": "wwi-factstockholding.csv",
						"folderPath": "bronze",
						"fileSystem": "dev"
					},
					"columnDelimiter": "|",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": ""
				},
				"schema": [
					{
						"name": "Stock Holding Key|Stock Item Key|Quantity On Hand|Bin Location|Last Stocktake Quantity|Last Cost Price|Reorder Level|Target Stock Level|Lineage Key",
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/asadatalake01')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/wwi_factstockholding_asa')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "sqlpool01",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlDWTable",
				"schema": [
					{
						"name": "StockHoldingKey",
						"type": "bigint",
						"precision": 19
					},
					{
						"name": "StockItemKey",
						"type": "int",
						"precision": 10
					},
					{
						"name": "QuantityOnHand",
						"type": "int",
						"precision": 10
					},
					{
						"name": "BinLocation",
						"type": "nvarchar"
					},
					{
						"name": "LastStocktakeQuantity",
						"type": "int",
						"precision": 10
					},
					{
						"name": "LastCostPrice",
						"type": "decimal",
						"precision": 18,
						"scale": 2
					},
					{
						"name": "ReorderLevel",
						"type": "int",
						"precision": 10
					},
					{
						"name": "TargetStockLevel",
						"type": "int",
						"precision": 10
					},
					{
						"name": "LineageKey",
						"type": "int",
						"precision": 10
					}
				],
				"typeProperties": {
					"schema": "wwi",
					"table": "FactStockHolding"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/sqlpool01')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/wwi_facttransaction_adls')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "asadatalake01",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": "wwi-facttransaction.csv",
						"folderPath": "bronze",
						"fileSystem": "dev"
					},
					"columnDelimiter": "|",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": ""
				},
				"schema": [
					{
						"name": "Transaction Key",
						"type": "String"
					},
					{
						"name": "Date Key",
						"type": "String"
					},
					{
						"name": "Customer Key",
						"type": "String"
					},
					{
						"name": "Bill To Customer Key",
						"type": "String"
					},
					{
						"name": "Supplier Key",
						"type": "String"
					},
					{
						"name": "Transaction Type Key",
						"type": "String"
					},
					{
						"name": "Payment Method Key",
						"type": "String"
					},
					{
						"name": "WWI Customer Transaction ID",
						"type": "String"
					},
					{
						"name": "WWI Supplier Transaction ID",
						"type": "String"
					},
					{
						"name": "WWI Invoice ID",
						"type": "String"
					},
					{
						"name": "WWI Purchase Order ID",
						"type": "String"
					},
					{
						"name": "Supplier Invoice Number",
						"type": "String"
					},
					{
						"name": "Total Excluding Tax",
						"type": "String"
					},
					{
						"name": "Tax Amount",
						"type": "String"
					},
					{
						"name": "Total Including Tax",
						"type": "String"
					},
					{
						"name": "Outstanding Balance",
						"type": "String"
					},
					{
						"name": "Is Finalized",
						"type": "String"
					},
					{
						"name": "Lineage Key",
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/asadatalake01')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/wwi_facttransaction_asa')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "sqlpool01",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlDWTable",
				"schema": [
					{
						"name": "TransactionKey",
						"type": "bigint",
						"precision": 19
					},
					{
						"name": "DateKey",
						"type": "date"
					},
					{
						"name": "CustomerKey",
						"type": "int",
						"precision": 10
					},
					{
						"name": "BillToCustomerKey",
						"type": "int",
						"precision": 10
					},
					{
						"name": "SupplierKey",
						"type": "int",
						"precision": 10
					},
					{
						"name": "TransactionTypeKey",
						"type": "int",
						"precision": 10
					},
					{
						"name": "PaymentMethodKey",
						"type": "int",
						"precision": 10
					},
					{
						"name": "WWICustomerTransaction ID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "WWISupplierTransaction ID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "WWIInvoiceID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "WWIPurchaseOrderID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "SupplierInvoiceNumber",
						"type": "nvarchar"
					},
					{
						"name": "TotalExcludingTax",
						"type": "decimal",
						"precision": 18,
						"scale": 2
					},
					{
						"name": "TaxAmount",
						"type": "decimal",
						"precision": 18,
						"scale": 2
					},
					{
						"name": "TotalIncludingTax",
						"type": "decimal",
						"precision": 18,
						"scale": 2
					},
					{
						"name": "OutstandingBalance",
						"type": "decimal",
						"precision": 18,
						"scale": 2
					},
					{
						"name": "IsFinalized",
						"type": "bit"
					},
					{
						"name": "LineageKey",
						"type": "int",
						"precision": 10
					}
				],
				"typeProperties": {
					"schema": "wwi",
					"table": "FactTransaction"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/sqlpool01')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/wwi_perf_factsale_fast_asa')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "sqlpool01",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlDWTable",
				"schema": [
					{
						"name": "SaleKey",
						"type": "bigint",
						"precision": 19
					},
					{
						"name": "CityKey",
						"type": "int",
						"precision": 10
					},
					{
						"name": "CustomerKey",
						"type": "int",
						"precision": 10
					},
					{
						"name": "BillToCustomerKey",
						"type": "int",
						"precision": 10
					},
					{
						"name": "StockItemKey",
						"type": "int",
						"precision": 10
					},
					{
						"name": "InvoiceDateKey",
						"type": "date"
					},
					{
						"name": "DeliveryDateKey",
						"type": "date"
					},
					{
						"name": "SalespersonKey",
						"type": "int",
						"precision": 10
					},
					{
						"name": "WWIInvoiceID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Description",
						"type": "nvarchar"
					},
					{
						"name": "Package",
						"type": "nvarchar"
					},
					{
						"name": "Quantity",
						"type": "int",
						"precision": 10
					},
					{
						"name": "UnitPrice",
						"type": "decimal",
						"precision": 18,
						"scale": 2
					},
					{
						"name": "TaxRate",
						"type": "decimal",
						"precision": 18,
						"scale": 3
					},
					{
						"name": "TotalExcludingTax",
						"type": "decimal",
						"precision": 18,
						"scale": 2
					},
					{
						"name": "TaxAmount",
						"type": "decimal",
						"precision": 18,
						"scale": 2
					},
					{
						"name": "Profit",
						"type": "decimal",
						"precision": 18,
						"scale": 2
					},
					{
						"name": "TotalIncludingTax",
						"type": "decimal",
						"precision": 18,
						"scale": 2
					},
					{
						"name": "TotalDryItems",
						"type": "int",
						"precision": 10
					},
					{
						"name": "TotalChillerItems",
						"type": "int",
						"precision": 10
					},
					{
						"name": "LineageKey",
						"type": "int",
						"precision": 10
					}
				],
				"typeProperties": {
					"schema": "wwi_perf",
					"table": "FactSale_Fast"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/sqlpool01')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/wwi_perf_factsale_slow_asa')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "sqlpool01",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlDWTable",
				"schema": [
					{
						"name": "SaleKey",
						"type": "bigint",
						"precision": 19
					},
					{
						"name": "CityKey",
						"type": "int",
						"precision": 10
					},
					{
						"name": "CustomerKey",
						"type": "int",
						"precision": 10
					},
					{
						"name": "BillToCustomerKey",
						"type": "int",
						"precision": 10
					},
					{
						"name": "StockItemKey",
						"type": "int",
						"precision": 10
					},
					{
						"name": "InvoiceDateKey",
						"type": "date"
					},
					{
						"name": "DeliveryDateKey",
						"type": "date"
					},
					{
						"name": "SalespersonKey",
						"type": "int",
						"precision": 10
					},
					{
						"name": "WWIInvoiceID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Description",
						"type": "nvarchar"
					},
					{
						"name": "Package",
						"type": "nvarchar"
					},
					{
						"name": "Quantity",
						"type": "int",
						"precision": 10
					},
					{
						"name": "UnitPrice",
						"type": "decimal",
						"precision": 18,
						"scale": 2
					},
					{
						"name": "TaxRate",
						"type": "decimal",
						"precision": 18,
						"scale": 3
					},
					{
						"name": "TotalExcludingTax",
						"type": "decimal",
						"precision": 18,
						"scale": 2
					},
					{
						"name": "TaxAmount",
						"type": "decimal",
						"precision": 18,
						"scale": 2
					},
					{
						"name": "Profit",
						"type": "decimal",
						"precision": 18,
						"scale": 2
					},
					{
						"name": "TotalIncludingTax",
						"type": "decimal",
						"precision": 18,
						"scale": 2
					},
					{
						"name": "TotalDryItems",
						"type": "int",
						"precision": 10
					},
					{
						"name": "TotalChillerItems",
						"type": "int",
						"precision": 10
					},
					{
						"name": "LineageKey",
						"type": "int",
						"precision": 10
					}
				],
				"typeProperties": {
					"schema": "wwi_perf",
					"table": "FactSale_Slow"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/sqlpool01')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/wwi_staging_dimcustomer_asa')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "sqlpool01",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"UniqueId": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "AzureSqlDWTable",
				"schema": [],
				"typeProperties": {
					"schema": "wwi_staging",
					"table": {
						"value": "@concat('DimCustomer_',dataset().UniqueId)",
						"type": "Expression"
					}
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/sqlpool01')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/wwi_staging_enrichedcustomer_asa')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "sqlpool01",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"UniqueId": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "AzureSqlDWTable",
				"schema": [],
				"typeProperties": {
					"schema": "wwi_staging",
					"table": {
						"value": "@concat('EnrichedCustomer_', dataset().UniqueId)",
						"type": "Expression"
					}
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/sqlpool01')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/PowerBIWorkspaceLinkedService')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "PowerBIWorkspace",
				"typeProperties": {
					"workspaceID": "02fbc856-0768-4dad-b953-1dd023192bcb",
					"tenantID": "008502d6-3f79-46f0-ab37-9354e3fe80ff"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/asadatalake01')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"description": "Linked service to Primary storage account",
				"annotations": [],
				"type": "AzureBlobFS",
				"typeProperties": {
					"url": "[parameters('asadatalake01_properties_typeProperties_url')]",
					"accountKey": {
						"type": "SecureString",
						"value": "[parameters('asadatalake01_accountKey')]"
					}
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/asastore01')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"description": "Linked service to Blob Storage",
				"annotations": [],
				"type": "AzureBlobStorage",
				"typeProperties": {
					"connectionString": "[parameters('asastore01_connectionString')]"
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/sqlpool01')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"description": "Linked service for Dedicated SQL Pool",
				"annotations": [],
				"type": "AzureSqlDW",
				"typeProperties": {
					"connectionString": "[parameters('sqlpool01_connectionString')]"
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/uiap-synapse-aid-synapsews-WorkspaceDefaultSqlServer')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"parameters": {
					"DBName": {
						"type": "String"
					}
				},
				"annotations": [],
				"type": "AzureSqlDW",
				"typeProperties": {
					"connectionString": "[parameters('uiap-synapse-aid-synapsews-WorkspaceDefaultSqlServer_connectionString')]"
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/uiap-synapse-aid-synapsews-WorkspaceDefaultStorage')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "AzureBlobFS",
				"typeProperties": {
					"url": "[parameters('uiap-synapse-aid-synapsews-WorkspaceDefaultStorage_properties_typeProperties_url')]"
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/AutoResolveIntegrationRuntime')]",
			"type": "Microsoft.Synapse/workspaces/integrationRuntimes",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"type": "Managed",
				"typeProperties": {
					"computeProperties": {
						"location": "AutoResolve",
						"dataFlowProperties": {
							"computeType": "General",
							"coreCount": 8,
							"timeToLive": 0
						}
					}
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/EnrichCustomerData')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "external_postalcode_adls",
								"type": "DatasetReference"
							},
							"name": "PostalCodes"
						},
						{
							"dataset": {
								"referenceName": "wwi_staging_dimcustomer_asa",
								"type": "DatasetReference"
							},
							"name": "DimCustomer"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "wwi_staging_enrichedcustomer_asa",
								"type": "DatasetReference"
							},
							"name": "EnrichedCustomerData"
						},
						{
							"dataset": {
								"referenceName": "staging_enrichedcustomer_adls",
								"type": "DatasetReference"
							},
							"name": "EnrichedCustomerDataAdls"
						}
					],
					"transformations": [
						{
							"name": "PostalCodeFilter"
						},
						{
							"name": "JoinOnPostalCode"
						},
						{
							"name": "SelectDesiredColumns"
						}
					],
					"script": "parameters{\n\tUniqueId as string\n}\nsource(output(\n\t\tCity as string,\n\t\tState as string,\n\t\tZip as string,\n\t\tLatitude as double,\n\t\tLongitude as double,\n\t\tTimezone as short,\n\t\tDST as boolean\n\t),\n\tallowSchemaDrift: false,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> PostalCodes\nsource(output(\n\t\tCustomerKey as integer,\n\t\tWWICustomerID as integer,\n\t\tCustomer as string,\n\t\tBillToCustomer as string,\n\t\tCategory as string,\n\t\tBuyingGroup as string,\n\t\tPrimaryContact as string,\n\t\tPostalCode as string,\n\t\tValidFrom as timestamp,\n\t\tValidTo as timestamp,\n\t\tLineageKey as integer\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tformat: 'table',\n\tstaged: false) ~> DimCustomer\nPostalCodes filter(and(\n    greaterOrEqual(toInteger(Zip), 90000),\n    lesserOrEqual(toInteger(Zip), 98000)\n)) ~> PostalCodeFilter\nDimCustomer, PostalCodeFilter join(PostalCode == Zip,\n\tjoinType:'inner',\n\tbroadcast: 'auto')~> JoinOnPostalCode\nJoinOnPostalCode select(mapColumn(\n\t\tCustomerKey,\n\t\tWWICustomerID,\n\t\tCustomer,\n\t\tBillToCustomer,\n\t\tCategory,\n\t\tBuyingGroup,\n\t\tPrimaryContact,\n\t\tPostalCode,\n\t\tValidFrom,\n\t\tValidTo,\n\t\tLineageKey,\n\t\tCity,\n\t\tState,\n\t\tLatitude,\n\t\tLongitude,\n\t\tTimezone,\n\t\tDST\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> SelectDesiredColumns\nSelectDesiredColumns sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tdeletable:false,\n\tinsertable:true,\n\tupdateable:false,\n\tupsertable:false,\n\trecreate:true,\n\tformat: 'table',\n\tstaged: false,\n\tpartitionBy('hash', 1),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\terrorHandlingOption: 'stopOnFirstError') ~> EnrichedCustomerData\nSelectDesiredColumns sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet',\n\tpartitionFileNames:[(concat('enrichedcustomer_', $UniqueId, '.parquet'))],\n\tumask: 0022,\n\tpartitionBy('hash', 1),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> EnrichedCustomerDataAdls"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/datasets/external_postalcode_adls')]",
				"[concat(variables('workspaceId'), '/datasets/wwi_staging_dimcustomer_asa')]",
				"[concat(variables('workspaceId'), '/datasets/wwi_staging_enrichedcustomer_asa')]",
				"[concat(variables('workspaceId'), '/datasets/staging_enrichedcustomer_adls')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/WorkspaceSystemIdentity')]",
			"type": "Microsoft.Synapse/workspaces/credentials",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"type": "ManagedIdentity",
				"typeProperties": {}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Ex 1 Task 1_1 - Query parquet files from ADLS')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "Exercise 1"
				},
				"content": {
					"query": "SELECT\n    TOP 100 *\nFROM\n    OPENROWSET(\n        BULK 'https://azsynapseaiddl.dfs.core.windows.net/wwi/factsale-parquet/2012/Q1/InvoiceDateKey=2012-01-01/part-00007-82fb0c25-17e0-4fc1-8f67-dd23466240a5.c000.snappy.parquet',\n        FORMAT='PARQUET'\n    ) AS [result]\n\n\nSELECT\n   COUNT(*)\nFROM\n    OPENROWSET(\n        BULK 'https://azsynapseaiddl.dfs.core.windows.net/wwi/factsale-parquet/2012/Q1/InvoiceDateKey=2012-01-01/part-00007-82fb0c25-17e0-4fc1-8f67-dd23466240a5.c000.snappy.parquet',\n        FORMAT='PARQUET'\n    ) AS [result]\n",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"poolName": "Built-in",
						"databaseName": "master"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Ex 1 Task 1_2 - Read with SQL on-demand')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "Exercise 1"
				},
				"content": {
					"query": "SELECT\n    COUNT(*)\nFROM\n    OPENROWSET(\n        BULK 'https://azsynapseaiddl.dfs.core.windows.net/wwi/factsale-csv/2012/Q1/*/*',\n \t\tFORMAT = 'CSV', \n\t\tFIELDTERMINATOR ='|', \n        FIELDQUOTE = '',\n\t\tFIRSTROW = 2\n    ) \nWITH \n    (\n        SalesKey BIGINT,\n        CityKey INT,\n        CustomerKey INT,\n        BillToCustomerKey INT,\n        StockItemKey INT,\n        DeliveryDateKey DATE,\n        SalesPersonKey INT,\n        WWIInvoiceID INT,\n        Description VARCHAR(200),\n        Package VARCHAR(10),\n        Quantity INT,\n        UnitPrice DECIMAL(6,2),\n        TaxRate DECIMAL(6,2),\n        TotalExcludingTax DECIMAL(6,2),\n        TaxAmount DECIMAL(6,2),\n        Profit DECIMAL(6,2),\n        TotalIncludingTax DECIMAL(6,2),\n        TotalDryItems INT,\n        TotalChillerItems INT,\n        LineageKey INT\n    ) as S",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"poolName": "Built-in",
						"databaseName": "master"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Ex 4 Task 1 - Analyze Transactions')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "Exercise 4"
				},
				"content": {
					"query": "SELECT \n    CustomerKey, \n    SUM(Quantity) as Quantity\nFROM \n    wwi.FactSale\nGROUP BY \n    CustomerKey",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"poolName": "sqlpool01",
						"databaseName": "sqlpool01"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Ex 4 Task 2 - Investigate query performance')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "Exercise 4"
				},
				"content": {
					"query": "SELECT  count(*) from wwi_perf.FactSale_Slow\n\nSELECT  count(*) from wwi_perf.FactSale_Fast\n\nSELECT\n    FS.CustomerKey\n    ,MIN(FS.Quantity) as MinQuantity\n    ,MAX(FS.Quantity) as MaxQuantity\n    ,AVG(FS.TaxRate) as AvgTaxRate\n    ,AVG(FS.TaxAmount) as AvgTaxAmount\n    ,AVG(FS.TotalExcludingTax) as AverageSaleWithoutTax\n    ,AVG(FS.TotalIncludingTax) as AverageSaleWithTax\n    ,COUNT(DISTINCT FS.StockItemKey) as DistinctStockItems\n    ,COUNT(DISTINCT DC.Country) as DistinctCountries\nFROM\n    wwi_perf.FactSale_Slow FS\n    join wwi.DimCity DC ON\n        DC.CityKey = FS.CityKey\nGROUP BY\n    FS.CustomerKey\n\nSELECT\n    FS.CustomerKey\n    ,MIN(FS.Quantity) as MinQuantity\n    ,MAX(FS.Quantity) as MaxQuantity\n    ,AVG(FS.TaxRate) as AvgTaxRate\n    ,AVG(FS.TaxAmount) as AvgTaxAmount\n    ,AVG(FS.TotalExcludingTax) as AverageSaleWithoutTax\n    ,AVG(FS.TotalIncludingTax) as AverageSaleWithTax\n    ,COUNT(DISTINCT FS.StockItemKey) as DistinctStockItems\n    ,COUNT(DISTINCT DC.Country) as DistinctCountries\nFROM\n    wwi_perf.FactSale_Fast FS\n    join wwi.DimCity DC ON\n        DC.CityKey = FS.CityKey\nGROUP BY\n    FS.CustomerKey",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"poolName": "sqlpool01",
						"databaseName": "sqlpool01"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Ex 5 Task 1 - Predict with model')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "Exercise 5"
				},
				"content": {
					"query": "-- Retrieve the latest hex encoded ONNX model from the table\nDECLARE @model varbinary(max) = (SELECT Model FROM [wwi_ml].[MLModel] WHERE Id = (SELECT Top(1) max(ID) FROM [wwi_ml].[MLModel]));\n\n-- Run a prediction query\nSELECT d.*, p.*\nFROM PREDICT(MODEL = @model, DATA = [wwi].[SampleData] AS d,RUNTIME = ONNX) WITH (prediction real) AS p;\n\n-- Store a batch of predictions\nINSERT INTO PredictionResults\nSELECT d.*, p.Score\nFROM PREDICT(MODEL = @model, DATA = [wwi].[SampleData] AS d,RUNTIME = ONNX) WITH (prediction real) AS p;",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"poolName": "sqlpool01",
						"databaseName": "sqlpool01"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Exercise 5 - Create Sample Data for Predict')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "Exercise 5"
				},
				"content": {
					"query": "DROP TABLE [wwi].[SampleData]; \n\n\nCREATE TABLE [wwi].[SampleData] \n(\n    [customerkey] REAL, \n    [stockitemkey] REAL\n);\n\n\nINSERT INTO [wwi].[SampleData] ([customerkey], [stockitemkey])\nVALUES ( 11, 1 );\n\n\nSELECT * FROM [wwi].[SampleData];\n\n\n",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"poolName": "sqlpool01",
						"databaseName": "sqlpool01"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Exercise 5 - Register model')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "Exercise 5"
				},
				"content": {
					"query": "-- Use poly to load model into the model table\nCREATE MASTER KEY ENCRYPTION BY PASSWORD = 'fQv2fKq#FN7r'\n\n-- Create a database scoped credential with Azure storage account key (not a Shared Access Signature) as the secret.\nCREATE DATABASE SCOPED CREDENTIAL StorageCredential\nWITH\nIDENTITY = 'SHARED ACCESS SIGNATURE'\n, SECRET = '<blob_storage_account_key>'\n;\n\n-- Create an external data source with CREDENTIAL option.\nCREATE EXTERNAL DATA SOURCE ModelStorage\nWITH\n( LOCATION = 'wasbs://models@<blob_storage>.blob.core.windows.net'\n, CREDENTIAL = StorageCredential\n, TYPE = HADOOP\n)\n;\nCREATE EXTERNAL FILE FORMAT csv\nWITH (\nFORMAT_TYPE = DELIMITEDTEXT,\nFORMAT_OPTIONS (\nFIELD_TERMINATOR = ',',\nSTRING_DELIMITER = '',\nDATE_FORMAT = '',\nUSE_TYPE_DEFAULT = False\n)\n);\n\n\nCREATE EXTERNAL TABLE [wwi_ml].[MLModelExt]\n(\n[Model] [varbinary](max) NULL\n)\nWITH\n(\nLOCATION='/hex' ,\nDATA_SOURCE = ModelStorage ,\nFILE_FORMAT = csv ,\nREJECT_TYPE = VALUE ,\nREJECT_VALUE = 0\n)\nGO\n\n-- Verify access by running query\nSELECT Model, 'A simple model.'\nFROM wwi_ml.MLModelExt\n\n\nCREATE TABLE [wwi_ml].[MLModel]\n(\n[Id] [int] IDENTITY(1,1) NOT NULL,\n[Model] [varbinary](max) NULL,\n[Description] [varchar](200) NULL\n)\nWITH\n(\nDISTRIBUTION = REPLICATE,\nheap\n)\nGO\n\nINSERT INTO [wwi_ml].[MLModel]\nSELECT Model, 'A linear regression model.'\nFROM [wwi_ml].[MLModelExt]",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"poolName": "Built-in",
						"databaseName": "master"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Setup Task 5 - Configure the SQL on-demand pool')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "Setup"
				},
				"content": {
					"query": "CREATE DATABASE SQLOnDemand01\n\n\nCREATE CREDENTIAL [https://uiapsynapseaiddl.dfs.core.windows.net]\nWITH IDENTITY='User Identity';",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"poolName": "Built-in",
						"databaseName": "master"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Setup Task 6_1 - Configure SQLPool01')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "Setup"
				},
				"content": {
					"query": "create schema wwi\ngo\ncreate schema wwi_perf\ngo\ncreate schema wwi_staging\ngo\ncreate schema wwi_ml\ngo\n\nIF OBJECT_ID('wwi.DimCity', 'U') IS NOT NULL\n    DROP TABLE wwi.DimCity\nGO\n\n--Location was eliminated (data type geography not supported)\n\nCREATE TABLE [wwi].[DimCity]\n(\n    [CityKey] [int] NOT NULL,\n\t[WWICityID] [int] NOT NULL,\n\t[City] [nvarchar](50) NOT NULL,\n\t[StateProvince] [nvarchar](50) NOT NULL,\n\t[Country] [nvarchar](60) NOT NULL,\n\t[Continent] [nvarchar](30) NOT NULL,\n\t[SalesTerritory] [nvarchar](50) NOT NULL,\n\t[Region] [nvarchar](30) NOT NULL,\n\t[Subregion] [nvarchar](30) NOT NULL,\n\t[LatestRecordedPopulation] [bigint] NOT NULL,\n\t[ValidFrom] [datetime2](7) NOT NULL,\n\t[ValidTo] [datetime2](7) NOT NULL,\n\t[LineageKey] [int] NOT NULL\n)\nWITH\n(\n    DISTRIBUTION = REPLICATE\n)\nGO\n\nIF OBJECT_ID('wwi.DimCustomer', 'U') IS NOT NULL\n    DROP TABLE wwi.DimCustomer\nGO\n\nCREATE TABLE [wwi].[DimCustomer](\n\t[CustomerKey] [int] NOT NULL,\n\t[WWICustomerID] [int] NOT NULL,\n\t[Customer] [nvarchar](100) NOT NULL,\n\t[BillToCustomer] [nvarchar](100) NOT NULL,\n\t[Category] [nvarchar](50) NOT NULL,\n\t[BuyingGroup] [nvarchar](50) NOT NULL,\n\t[PrimaryContact] [nvarchar](50) NOT NULL,\n\t[PostalCode] [nvarchar](10) NOT NULL,\n\t[ValidFrom] [datetime2](7) NOT NULL,\n\t[ValidTo] [datetime2](7) NOT NULL,\n\t[LineageKey] [int] NOT NULL\n)\nWITH\n(\n    DISTRIBUTION = REPLICATE\n)\nGO\n\nIF OBJECT_ID('wwi.DimDate', 'U') IS NOT NULL\n    DROP TABLE wwi.DimDate\nGO\n\nCREATE TABLE [wwi].[DimDate](\n\t[Date] [date] NOT NULL,\n\t[DayNumber] [int] NOT NULL,\n\t[Day] [nvarchar](10) NOT NULL,\n\t[Month] [nvarchar](10) NOT NULL,\n\t[ShortMonth] [nvarchar](3) NOT NULL,\n\t[CalendarMonthNumber] [int] NOT NULL,\n\t[CalendarMonthLabel] [nvarchar](20) NOT NULL,\n\t[CalendarYear] [int] NOT NULL,\n\t[CalendarYearLabel] [nvarchar](10) NOT NULL,\n\t[FiscalMonthNumber] [int] NOT NULL,\n\t[FiscalMonthLabel] [nvarchar](20) NOT NULL,\n\t[FiscalYear] [int] NOT NULL,\n\t[FiscalYearLabel] [nvarchar](10) NOT NULL,\n\t[ISOWeekNumber] [int] NOT NULL\n)\nWITH\n(\n    DISTRIBUTION = REPLICATE\n)\nGO\n\nIF OBJECT_ID('wwi.DimEmployee', 'U') IS NOT NULL\n    DROP TABLE wwi.DimEmployee\nGO\n\n-- Photo was eliminated (data type varbinary cannot participate in a columnstore index)\n\nCREATE TABLE [wwi].[DimEmployee](\n\t[EmployeeKey] [int] NOT NULL,\n\t[WWIEmployeeID] [int] NOT NULL,\n\t[Employee] [nvarchar](50) NOT NULL,\n\t[PreferredName] [nvarchar](50) NOT NULL,\n\t[IsSalesperson] [bit] NOT NULL,\n\t[ValidFrom] [datetime2](7) NOT NULL,\n\t[ValidTo] [datetime2](7) NOT NULL,\n\t[LineageKey] [int] NOT NULL\n)\nWITH\n(\n    DISTRIBUTION = REPLICATE\n)\nGO\n\nIF OBJECT_ID('wwi.DimPaymentMethod', 'U') IS NOT NULL\n    DROP TABLE wwi.DimPaymentMethod\nGO\n\nCREATE TABLE [wwi].[DimPaymentMethod](\n\t[PaymentMethodKey] [int] NOT NULL,\n\t[WWIPaymentMethodID] [int] NOT NULL,\n\t[PaymentMethod] [nvarchar](50) NOT NULL,\n\t[ValidFrom] [datetime2](7) NOT NULL,\n\t[ValidTo] [datetime2](7) NOT NULL,\n\t[LineageKey] [int] NOT NULL\n)\nWITH\n(\n    DISTRIBUTION = REPLICATE\n)\nGO\n\nIF OBJECT_ID('wwi.DimStockItem', 'U') IS NOT NULL\n    DROP TABLE wwi.DimStockItem\nGO\n\n-- Photo was eliminated (data type varbinary cannot participate in a columnstore index)\n\nCREATE TABLE [wwi].[DimStockItem](\n\t[StockItemKey] [int] NOT NULL,\n\t[WWIStockItemID] [int] NOT NULL,\n\t[Stock Item] [nvarchar](100) NOT NULL,\n\t[Color] [nvarchar](20) NOT NULL,\n\t[SellingPackage] [nvarchar](50) NOT NULL,\n\t[Buying Package] [nvarchar](50) NOT NULL,\n\t[Brand] [nvarchar](50) NOT NULL,\n\t[Size] [nvarchar](20) NOT NULL,\n\t[LeadTimeDays] [int] NOT NULL,\n\t[QuantityPerOuter] [int] NOT NULL,\n\t[IsChillerStock] [bit] NOT NULL,\n\t[Barcode] [nvarchar](50) NULL,\n\t[TaxRate] [decimal](18, 3) NOT NULL,\n\t[UnitPrice] [decimal](18, 2) NOT NULL,\n\t[RecommendedRetailPrice] [decimal](18, 2) NULL,\n\t[TypicalWeightPerUnit] [decimal](18, 3) NOT NULL,\n\t[ValidFrom] [datetime2](7) NOT NULL,\n\t[ValidTo] [datetime2](7) NOT NULL,\n\t[LineageKey] [int] NOT NULL\n)\nWITH\n(\n    DISTRIBUTION = REPLICATE\n)\nGO\n\nIF OBJECT_ID('wwi.DimSupplier', 'U') IS NOT NULL\n    DROP TABLE wwi.DimSupplier\nGO\n\n\nCREATE TABLE [wwi].[DimSupplier](\n\t[SupplierKey] [int] NOT NULL,\n\t[WWISupplierID] [int] NOT NULL,\n\t[Supplier] [nvarchar](100) NOT NULL,\n\t[Category] [nvarchar](50) NOT NULL,\n\t[PrimaryContact] [nvarchar](50) NOT NULL,\n\t[SupplierReference] [nvarchar](20) NULL,\n\t[PaymentDays] [int] NOT NULL,\n\t[PostalCode] [nvarchar](10) NOT NULL,\n\t[ValidFrom] [datetime2](7) NOT NULL,\n\t[ValidTo] [datetime2](7) NOT NULL,\n\t[LineageKey] [int] NOT NULL\n)\nWITH\n(\n    DISTRIBUTION = REPLICATE\n)\nGO\n\nIF OBJECT_ID('wwi.DimTransactionType', 'U') IS NOT NULL\n    DROP TABLE wwi.DimTransactionType\nGO\n\nCREATE TABLE [wwi].[DimTransactionType](\n\t[TransactionTypeKey] [int] NOT NULL,\n\t[WWITransactionTypeID] [int] NOT NULL,\n\t[TransactionType] [nvarchar](50) NOT NULL,\n\t[ValidFrom] [datetime2](7) NOT NULL,\n\t[ValidTo] [datetime2](7) NOT NULL,\n\t[LineageKey] [int] NOT NULL\n)\nWITH\n(\n    DISTRIBUTION = REPLICATE\n)\nGO\n\nIF OBJECT_ID('wwi.FactMovement', 'U') IS NOT NULL\n    DROP TABLE wwi.FactMovement\nGO\n\nCREATE TABLE [wwi].[FactMovement](\n\t[MovementKey] [bigint] IDENTITY(1,1) NOT NULL,\n\t[DateKey] [date] NOT NULL,\n\t[StockItemKey] [int] NOT NULL,\n\t[CustomerKey] [int] NULL,\n\t[SupplierKey] [int] NULL,\n\t[TransactionTypeKey] [int] NOT NULL,\n\t[WWIStockItemTransactionID] [int] NOT NULL,\n\t[WWIInvoiceID] [int] NULL,\n\t[WWIPurchaseOrderID] [int] NULL,\n\t[Quantity] [int] NOT NULL,\n\t[LineageKey] [int] NOT NULL\n)\nWITH\n(\n    DISTRIBUTION = HASH ([CustomerKey]),\n    CLUSTERED COLUMNSTORE INDEX\n)\nGO\n\nIF OBJECT_ID('wwi.FactOrder', 'U') IS NOT NULL\n    DROP TABLE wwi.FactOrder\nGO\n\nCREATE TABLE [wwi].[FactOrder](\n\t[OrderKey] [bigint] IDENTITY(1,1) NOT NULL,\n\t[CityKey] [int] NOT NULL,\n\t[CustomerKey] [int] NOT NULL,\n\t[StockItemKey] [int] NOT NULL,\n\t[OrderDateKey] [date] NOT NULL,\n\t[PickedDateKey] [date] NULL,\n\t[SalespersonKey] [int] NOT NULL,\n\t[PickerKey] [int] NULL,\n\t[WWIOrderID] [int] NOT NULL,\n\t[WWIBackorderID] [int] NULL,\n\t[Description] [nvarchar](100) NOT NULL,\n\t[Package] [nvarchar](50) NOT NULL,\n\t[Quantity] [int] NOT NULL,\n\t[UnitPrice] [decimal](18, 2) NOT NULL,\n\t[TaxRate] [decimal](18, 3) NOT NULL,\n\t[TotalExcludingTax] [decimal](18, 2) NOT NULL,\n\t[TaxAmount] [decimal](18, 2) NOT NULL,\n\t[TotalIncludingTax] [decimal](18, 2) NOT NULL,\n\t[LineageKey] [int] NOT NULL\n)\nWITH\n(\n    DISTRIBUTION = HASH ([CustomerKey]),\n    CLUSTERED COLUMNSTORE INDEX\n)\nGO\n\nIF OBJECT_ID('wwi.FactPurchase', 'U') IS NOT NULL\n    DROP TABLE wwi.FactPurchase\nGO\n\nCREATE TABLE [wwi].[FactPurchase](\n\t[PurchaseKey] [bigint] IDENTITY(1,1) NOT NULL,\n\t[DateKey] [date] NOT NULL,\n\t[SupplierKey] [int] NOT NULL,\n\t[StockItemKey] [int] NOT NULL,\n\t[WWIPurchaseOrderID] [int] NULL,\n\t[OrderedOuters] [int] NOT NULL,\n\t[OrderedQuantity] [int] NOT NULL,\n\t[ReceivedOuters] [int] NOT NULL,\n\t[Package] [nvarchar](50) NOT NULL,\n\t[IsOrderFinalized] [bit] NOT NULL,\n\t[LineageKey] [int] NOT NULL\n)\nWITH\n(\n    DISTRIBUTION = HASH ([SupplierKey]),\n    CLUSTERED COLUMNSTORE INDEX\n)\nGO\n\nIF OBJECT_ID('wwi.FactSale', 'U') IS NOT NULL\n    DROP TABLE wwi.FactSale\nGO\n\nCREATE TABLE [wwi].[FactSale](\n\t[SaleKey] [bigint] IDENTITY(1,1) NOT NULL,\n\t[CityKey] [int] NOT NULL,\n\t[CustomerKey] [int] NOT NULL,\n\t[BillToCustomerKey] [int] NOT NULL,\n\t[StockItemKey] [int] NOT NULL,\n\t[InvoiceDateKey] [date] NOT NULL,\n\t[DeliveryDateKey] [date] NULL,\n\t[SalespersonKey] [int] NOT NULL,\n\t[WWIInvoiceID] [int] NOT NULL,\n\t[Description] [nvarchar](100) NOT NULL,\n\t[Package] [nvarchar](50) NOT NULL,\n\t[Quantity] [int] NOT NULL,\n\t[UnitPrice] [decimal](18, 2) NOT NULL,\n\t[TaxRate] [decimal](18, 3) NOT NULL,\n\t[TotalExcludingTax] [decimal](18, 2) NOT NULL,\n\t[TaxAmount] [decimal](18, 2) NOT NULL,\n\t[Profit] [decimal](18, 2) NOT NULL,\n\t[TotalIncludingTax] [decimal](18, 2) NOT NULL,\n\t[TotalDryItems] [int] NOT NULL,\n\t[TotalChillerItems] [int] NOT NULL,\n\t[LineageKey] [int] NOT NULL\n)\nWITH\n(\n    DISTRIBUTION = HASH ([CustomerKey]),\n    CLUSTERED COLUMNSTORE INDEX\n)\nGO\n\nIF OBJECT_ID('wwi_perf.FactSale_Slow', 'U') IS NOT NULL\n    DROP TABLE wwi_perf.FactSale\nGO\n\nCREATE TABLE [wwi_perf].[FactSale_Slow](\n\t[SaleKey] [bigint] IDENTITY(1,1) NOT NULL,\n\t[CityKey] [int] NOT NULL,\n\t[CustomerKey] [int] NOT NULL,\n\t[BillToCustomerKey] [int] NOT NULL,\n\t[StockItemKey] [int] NOT NULL,\n\t[InvoiceDateKey] [date] NOT NULL,\n\t[DeliveryDateKey] [date] NULL,\n\t[SalespersonKey] [int] NOT NULL,\n\t[WWIInvoiceID] [int] NOT NULL,\n\t[Description] [nvarchar](100) NOT NULL,\n\t[Package] [nvarchar](50) NOT NULL,\n\t[Quantity] [int] NOT NULL,\n\t[UnitPrice] [decimal](18, 2) NOT NULL,\n\t[TaxRate] [decimal](18, 3) NOT NULL,\n\t[TotalExcludingTax] [decimal](18, 2) NOT NULL,\n\t[TaxAmount] [decimal](18, 2) NOT NULL,\n\t[Profit] [decimal](18, 2) NOT NULL,\n\t[TotalIncludingTax] [decimal](18, 2) NOT NULL,\n\t[TotalDryItems] [int] NOT NULL,\n\t[TotalChillerItems] [int] NOT NULL,\n\t[LineageKey] [int] NOT NULL\n)\nWITH\n(\n    DISTRIBUTION = ROUND_ROBIN,\n    CLUSTERED COLUMNSTORE INDEX\n)\nGO\n\nIF OBJECT_ID('wwi_perf.FactSale_Fast', 'U') IS NOT NULL\n    DROP TABLE wwi_perf.FactSale_Fast\nGO\n\nCREATE TABLE [wwi_perf].[FactSale_Fast](\n\t[SaleKey] [bigint] IDENTITY(1,1) NOT NULL,\n\t[CityKey] [int] NOT NULL,\n\t[CustomerKey] [int] NOT NULL,\n\t[BillToCustomerKey] [int] NOT NULL,\n\t[StockItemKey] [int] NOT NULL,\n\t[InvoiceDateKey] [date] NOT NULL,\n\t[DeliveryDateKey] [date] NULL,\n\t[SalespersonKey] [int] NOT NULL,\n\t[WWIInvoiceID] [int] NOT NULL,\n\t[Description] [nvarchar](100) NOT NULL,\n\t[Package] [nvarchar](50) NOT NULL,\n\t[Quantity] [int] NOT NULL,\n\t[UnitPrice] [decimal](18, 2) NOT NULL,\n\t[TaxRate] [decimal](18, 3) NOT NULL,\n\t[TotalExcludingTax] [decimal](18, 2) NOT NULL,\n\t[TaxAmount] [decimal](18, 2) NOT NULL,\n\t[Profit] [decimal](18, 2) NOT NULL,\n\t[TotalIncludingTax] [decimal](18, 2) NOT NULL,\n\t[TotalDryItems] [int] NOT NULL,\n\t[TotalChillerItems] [int] NOT NULL,\n\t[LineageKey] [int] NOT NULL\n)\nWITH\n(\n    DISTRIBUTION = HASH ([CustomerKey]),\n    CLUSTERED COLUMNSTORE INDEX\n)\nGO\n\nIF OBJECT_ID('wwi.FactStockHolding', 'U') IS NOT NULL\n    DROP TABLE wwi.FactStockHolding\nGO\n\nCREATE TABLE [wwi].[FactStockHolding](\n\t[StockHoldingKey] [bigint] IDENTITY(1,1) NOT NULL,\n\t[StockItemKey] [int] NOT NULL,\n\t[QuantityOnHand] [int] NOT NULL,\n\t[BinLocation] [nvarchar](20) NOT NULL,\n\t[LastStocktakeQuantity] [int] NOT NULL,\n\t[LastCostPrice] [decimal](18, 2) NOT NULL,\n\t[ReorderLevel] [int] NOT NULL,\n\t[TargetStockLevel] [int] NOT NULL,\n\t[LineageKey] [int] NOT NULL\n)\nWITH\n(\n    DISTRIBUTION = HASH ([StockItemKey]),\n    CLUSTERED COLUMNSTORE INDEX\n)\nGO\n\nIF OBJECT_ID('wwi.FactTransaction', 'U') IS NOT NULL\n    DROP TABLE wwi.FactTransaction\nGO\n\nCREATE TABLE [wwi].[FactTransaction](\n\t[TransactionKey] [bigint] IDENTITY(1,1) NOT NULL,\n\t[DateKey] [date] NOT NULL,\n\t[CustomerKey] [int] NULL,\n\t[BillToCustomerKey] [int] NULL,\n\t[SupplierKey] [int] NULL,\n\t[TransactionTypeKey] [int] NOT NULL,\n\t[PaymentMethodKey] [int] NULL,\n\t[WWICustomerTransaction ID] [int] NULL,\n\t[WWISupplierTransaction ID] [int] NULL,\n\t[WWIInvoiceID] [int] NULL,\n\t[WWIPurchaseOrderID] [int] NULL,\n\t[SupplierInvoiceNumber] [nvarchar](20) NULL,\n\t[TotalExcludingTax] [decimal](18, 2) NOT NULL,\n\t[TaxAmount] [decimal](18, 2) NOT NULL,\n\t[TotalIncludingTax] [decimal](18, 2) NOT NULL,\n\t[OutstandingBalance] [decimal](18, 2) NOT NULL,\n\t[IsFinalized] [bit] NOT NULL,\n\t[LineageKey] [int] NOT NULL\n)\nWITH\n(\n    DISTRIBUTION = HASH ([CustomerKey]),\n    CLUSTERED COLUMNSTORE INDEX\n)\nGO\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"poolName": "uiapsynapseaiddsql",
						"databaseName": "uiapsynapseaiddsql"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Setup Task 6_2 - Create the login')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "Setup"
				},
				"content": {
					"query": "CREATE LOGIN [asa.sql.staging]\nWITH PASSWORD = 'Temp1234'\nGO\n\n\nCREATE USER [asa.sql.staging]\n    FOR LOGIN [asa.sql.staging]\n    WITH DEFAULT_SCHEMA = dbo\nGO\n\n-- Add user to the required roles\n\nEXEC sp_addrolemember N'db_datareader', N'asa.sql.staging'\nGO\nEXEC sp_addrolemember N'db_datawriter', N'asa.sql.staging'\nGO\nEXEC sp_addrolemember N'db_ddladmin', N'asa.sql.staging'\nGO\n\n--Create user in DB\nCREATE USER [uiap-synapse-aid-synapsews] FROM EXTERNAL PROVIDER;\n\n--Granting permission to the identity\nGRANT CONTROL ON DATABASE::uiapsynapseaiddsql TO [uiap-synapse-aid-synapsews];",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"poolName": "uiapsynapseaiddsql",
						"databaseName": "master"
					},
					"resultLimit": 5000
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Ex 1 Task 2 - Explore Data Lake with Spark')]",
			"type": "Microsoft.Synapse/workspaces/notebooks",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "Exercise 1"
				},
				"nbformat": 4,
				"nbformat_minor": 2,
				"bigDataPool": {
					"referenceName": "SparkPool01",
					"type": "BigDataPoolReference"
				},
				"sessionProperties": {
					"driverMemory": "28g",
					"driverCores": 4,
					"executorMemory": "28g",
					"executorCores": 4,
					"numExecutors": 2,
					"conf": {
						"spark.dynamicAllocation.enabled": "false",
						"spark.dynamicAllocation.minExecutors": "2",
						"spark.dynamicAllocation.maxExecutors": "2"
					}
				},
				"metadata": {
					"saveOutput": true,
					"synapse_widget": {
						"version": "0.1"
					},
					"kernelspec": {
						"name": "synapse_pyspark",
						"display_name": "Synapse PySpark"
					},
					"language_info": {
						"name": "python"
					},
					"a365ComputeOptions": {
						"id": "/subscriptions/06a2d317-3061-45f6-89b4-4ef3424d6693/resourceGroups/azure-synapse-aidlab-rg/providers/Microsoft.Synapse/workspaces/az-synapse-aid-lab-ws/bigDataPools/SparkPool01",
						"name": "SparkPool01",
						"type": "Spark",
						"endpoint": "https://az-synapse-aid-lab-ws.dev.azuresynapse.net/livyApi/versions/2019-11-01-preview/sparkPools/SparkPool01",
						"auth": {
							"type": "AAD",
							"authResource": "https://dev.azuresynapse.net"
						},
						"sparkVersion": "2.4",
						"nodeCount": 10,
						"cores": 4,
						"memory": 28
					}
				},
				"cells": [
					{
						"cell_type": "code",
						"metadata": {
							"microsoft": {
								"language": "python"
							},
							"collapsed": false
						},
						"source": [
							"%%pyspark\r\n",
							"df = spark.read.load('abfss://wwi@azsynapseaiddl.dfs.core.windows.net/factsale-parquet/2012/Q1/InvoiceDateKey=2012-01-01/part-00007-82fb0c25-17e0-4fc1-8f67-dd23466240a5.c000.snappy.parquet', format='parquet')\r\n",
							"display(df.limit(100))"
						],
						"outputs": [],
						"execution_count": 4
					},
					{
						"cell_type": "code",
						"metadata": {
							"jupyter": {
								"source_hidden": false,
								"outputs_hidden": false
							},
							"nteract": {
								"transient": {
									"deleting": false
								}
							},
							"collapsed": false
						},
						"source": [
							"data_path = spark.read.load(\r\n",
							"   'abfss://wwi@azsynapseaiddl.dfs.core.windows.net/factsale-csv/2012/Q1/*/*',\r\n",
							"   format='csv',\r\n",
							"   sep=\"|\",\r\n",
							"   header=True)\r\n",
							"\r\n",
							"display(data_path.limit(100))"
						],
						"outputs": [],
						"execution_count": 3
					}
				]
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Ex 2 - Bonus Notebook with CSharp')]",
			"type": "Microsoft.Synapse/workspaces/notebooks",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "Exercise 2"
				},
				"nbformat": 0,
				"nbformat_minor": 0,
				"bigDataPool": {
					"referenceName": "SparkPool01",
					"type": "BigDataPoolReference"
				},
				"sessionProperties": {
					"driverMemory": "28g",
					"driverCores": 4,
					"executorMemory": "28g",
					"executorCores": 4,
					"numExecutors": 2,
					"conf": {
						"spark.dynamicAllocation.enabled": "false",
						"spark.dynamicAllocation.minExecutors": "2",
						"spark.dynamicAllocation.maxExecutors": "2"
					}
				},
				"metadata": {
					"saveOutput": true,
					"synapse_widget": {
						"version": "0.1"
					},
					"kernelspec": {
						"name": "synapse_sparkdotnet",
						"display_name": "Synapse SparkDotNet"
					},
					"language_info": {
						"name": "csharp"
					},
					"a365ComputeOptions": {
						"id": "/subscriptions/06a2d317-3061-45f6-89b4-4ef3424d6693/resourceGroups/azure-synapse-aidlab-rg/providers/Microsoft.Synapse/workspaces/az-synapse-aid-lab-ws/bigDataPools/SparkPool01",
						"name": "SparkPool01",
						"type": "Spark",
						"endpoint": "https://az-synapse-aid-lab-ws.dev.azuresynapse.net/livyApi/versions/2019-11-01-preview/sparkPools/SparkPool01",
						"auth": {
							"type": "AAD",
							"authResource": "https://dev.azuresynapse.net"
						},
						"sparkVersion": "2.4",
						"nodeCount": 10,
						"cores": 4,
						"memory": 28
					}
				},
				"cells": [
					{
						"cell_type": "code",
						"source": [
							"// Configure the connection to the data lake\n",
							"var adlsPath = \"abfss://wwi@azsynapseaiddl.dfs.core.windows.net\";"
						],
						"outputs": [],
						"execution_count": 3
					},
					{
						"cell_type": "code",
						"source": [
							"// Import the sales data from the data lake\n",
							"var sales = spark.Read().Option(\"header\", \"true\").Option(\"inferSchema\", \"true\").Option(\"sep\", \"|\").Csv($\"{adlsPath}/factsale-csv/2012/Q4\");\n",
							"sales.Show(5);\n",
							"sales.PrintSchema();"
						],
						"outputs": [],
						"execution_count": 4
					},
					{
						"cell_type": "code",
						"source": [
							"using System;\n",
							"using System.Collections.Generic;\n",
							"\n",
							"// Set up a JDBC connection to Azure Synapse Analytics\n",
							"var jdbcUsername = \"asa.sql.staging@az-synapse-aid-lab-ws\";\n",
							"var jdbcPassword = \"Temp1234\";\n",
							"var jdbcConnectionString = $\"jdbc:sqlserver://az-synapse-aid-lab-ws.sql.azuresynapse.net:1433;database=sqlpool01;\";\n",
							"\n",
							"// Set target table name\n",
							"var tableName = $\"wwi_staging.Sale_CSharp\";\n",
							"\n",
							"// Write the retrieved sales data into a staging table in Azure Synapse Analytics.\n",
							"sales\n",
							"    .Limit(1500)\n",
							"    .Write()\n",
							"    .Format(\"jdbc\")\n",
							"    .Options(\n",
							"        new Dictionary<string, string>\n",
							"        {\n",
							"            {\"url\", jdbcConnectionString},\n",
							"            {\"dbtable\", tableName},\n",
							"            {\"user\", jdbcUsername},\n",
							"            {\"password\", jdbcPassword},\n",
							"            {\"encrypt\", \"false\"},\n",
							"            {\"trustServerCertificate\", \"true\"},\n",
							"            {\"createTableColumnTypes\", \"Description VARCHAR(100), Package VARCHAR(50)\"} // Override the column types for string values. They are assigned nvarchar(max) by default, and that is not compatible with columnstore index.\n",
							"        }\n",
							"    )\n",
							"    .Mode(\"append\")\n",
							"    .Save();"
						],
						"outputs": [],
						"execution_count": 6
					}
				]
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Ex 2 Task 1 - Explore and modify a notebook')]",
			"type": "Microsoft.Synapse/workspaces/notebooks",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "Exercise 2"
				},
				"nbformat": 4,
				"nbformat_minor": 2,
				"bigDataPool": {
					"referenceName": "SparkPool01",
					"type": "BigDataPoolReference"
				},
				"sessionProperties": {
					"driverMemory": "28g",
					"driverCores": 4,
					"executorMemory": "28g",
					"executorCores": 4,
					"numExecutors": 2,
					"conf": {
						"spark.dynamicAllocation.enabled": "false",
						"spark.dynamicAllocation.minExecutors": "2",
						"spark.dynamicAllocation.maxExecutors": "2"
					}
				},
				"metadata": {
					"saveOutput": true,
					"synapse_widget": {
						"version": "0.1"
					},
					"kernelspec": {
						"name": "synapse_pyspark",
						"display_name": "Synapse PySpark"
					},
					"language_info": {
						"name": "python"
					},
					"a365ComputeOptions": {
						"id": "/subscriptions/06a2d317-3061-45f6-89b4-4ef3424d6693/resourceGroups/azure-synapse-aidlab-rg/providers/Microsoft.Synapse/workspaces/az-synapse-aid-lab-ws/bigDataPools/SparkPool01",
						"name": "SparkPool01",
						"type": "Spark",
						"endpoint": "https://az-synapse-aid-lab-ws.dev.azuresynapse.net/livyApi/versions/2019-11-01-preview/sparkPools/SparkPool01",
						"auth": {
							"type": "AAD",
							"authResource": "https://dev.azuresynapse.net"
						},
						"sparkVersion": "2.4",
						"nodeCount": 10,
						"cores": 4,
						"memory": 28
					}
				},
				"cells": [
					{
						"cell_type": "code",
						"metadata": {
							"microsoft": {
								"language": "scala"
							}
						},
						"source": [
							"%%spark\r\n",
							"\r\n",
							"// Set the path to read the WWI Sales files\r\n",
							"import org.apache.spark.sql.SparkSession\r\n",
							"\r\n",
							"// Set the path to the ADLS Gen2 account\r\n",
							"val adlsPath = \"abfss://wwi@azsynapseaiddl.dfs.core.windows.net\""
						],
						"outputs": [],
						"execution_count": 1
					},
					{
						"cell_type": "code",
						"metadata": {
							"jupyter": {
								"source_hidden": false,
								"outputs_hidden": false
							},
							"nteract": {
								"transient": {
									"deleting": false
								}
							},
							"microsoft": {
								"language": "scala"
							},
							"collapsed": true
						},
						"source": [
							"%%spark\r\n",
							"\r\n",
							"// Read the sales into a dataframe\r\n",
							"val sales = spark.read.format(\"csv\").option(\"header\", \"true\").option(\"inferSchema\", \"true\").option(\"sep\", \"|\").load(s\"$adlsPath/factsale-csv/2012/Q4\")\r\n",
							"sales.show(5)\r\n",
							"sales.printSchema()"
						],
						"outputs": [],
						"execution_count": 2
					},
					{
						"cell_type": "code",
						"metadata": {
							"jupyter": {
								"source_hidden": false,
								"outputs_hidden": false
							},
							"nteract": {
								"transient": {
									"deleting": false
								}
							},
							"microsoft": {
								"language": "scala"
							},
							"collapsed": true
						},
						"source": [
							"%%spark\r\n",
							"\r\n",
							"// Import libraries for the SQL Analytics connector\r\n",
							"import com.microsoft.spark.sqlanalytics.utils.Constants\r\n",
							"import org.apache.spark.sql.SqlAnalyticsConnector._\r\n",
							"import org.apache.spark.sql.SaveMode\r\n",
							"\r\n",
							"// Set target table name\r\n",
							"var tableName = s\"SQLPool01.wwi_staging.Sale\"\r\n",
							"\r\n",
							"// Write the retrieved sales data into a staging table in Azure Synapse Analytics.\r\n",
							"sales.limit(10000).write.mode(SaveMode.Append).sqlanalytics(tableName, Constants.INTERNAL)"
						],
						"outputs": [],
						"execution_count": 3
					},
					{
						"cell_type": "code",
						"metadata": {
							"jupyter": {
								"source_hidden": false,
								"outputs_hidden": false
							},
							"nteract": {
								"transient": {
									"deleting": false
								}
							},
							"collapsed": true
						},
						"source": [
							""
						],
						"outputs": [],
						"execution_count": null
					}
				]
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Ex 5 Task 2 - Model Training')]",
			"type": "Microsoft.Synapse/workspaces/notebooks",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "Exercise 5"
				},
				"nbformat": 0,
				"nbformat_minor": 0,
				"sessionProperties": {
					"driverMemory": "28g",
					"driverCores": 4,
					"executorMemory": "28g",
					"executorCores": 4,
					"numExecutors": 2,
					"conf": {
						"spark.dynamicAllocation.enabled": "false",
						"spark.dynamicAllocation.minExecutors": "2",
						"spark.dynamicAllocation.maxExecutors": "2"
					}
				},
				"metadata": {
					"saveOutput": true,
					"synapse_widget": {
						"version": "0.1"
					},
					"kernelspec": {
						"name": "synapse_pyspark",
						"display_name": "python"
					},
					"language_info": {
						"name": "python"
					}
				},
				"cells": [
					{
						"cell_type": "markdown",
						"source": [
							"# Model training and registration\n",
							"This notebook show the process for training the model, converting the model to ONNX and uploading the ONNX model to Azure Storage."
						]
					},
					{
						"cell_type": "markdown",
						"source": [
							"## Explore the training data\n",
							"The following cells load the source CSV file into a Spark DataFrame and create a temporary view that can be used to query the data with Spark SQL.\n",
							""
						]
					},
					{
						"cell_type": "code",
						"source": [
							"df = spark.read.load('abfss://dev@<primary_storage>.dfs.core.windows.net/bronze/wwi-factsale.csv', format=\"csv\"\r\n",
							"## If header exists uncomment line bellow\r\n",
							", header=True, sep=\"|\"\r\n",
							")"
						],
						"outputs": [],
						"execution_count": 35
					},
					{
						"cell_type": "code",
						"source": [
							"df.createOrReplaceTempView(\"facts\")"
						],
						"outputs": [],
						"execution_count": 36
					},
					{
						"cell_type": "code",
						"metadata": {
							"collapsed": false
						},
						"source": [
							"display(spark.sql(\"SELECT * FROM facts WHERE `Customer Key` == '11' ORDER BY `Stock Item Key`\"))"
						],
						"outputs": [],
						"execution_count": 37
					},
					{
						"cell_type": "markdown",
						"source": [
							"## Predict Quantity given Customer Key and Stock Item Key\n",
							"In the following cells we load a subset of the data that just contains the fields needed for training. \n",
							"\n",
							""
						]
					},
					{
						"cell_type": "code",
						"metadata": {
							"collapsed": false
						},
						"source": [
							"from pyspark.sql.functions import col\n",
							"df3 = spark.sql(\"SELECT double(`Customer Key`) as customerkey, double(`Stock Item Key`) as stockitemkey, double(`Quantity`) as quantity FROM facts\").where(col(\"quantity\").isNotNull())\n",
							"df3.cache()\n",
							"print(\"Number of records:\", df3.count())\n",
							"df3.show(10)"
						],
						"outputs": [],
						"execution_count": 38
					},
					{
						"cell_type": "markdown",
						"source": [
							"Now, we split our DataFrame into training and testing DataFrames.\n",
							""
						]
					},
					{
						"cell_type": "code",
						"source": [
							"trainingFraction = 0.7\n",
							"testingFraction = (1-trainingFraction)\n",
							"seed = 42\n",
							"\n",
							"# Split the dataframe into test and training dataframes\n",
							"df_train, df_test = df3.randomSplit([trainingFraction, testingFraction], seed=seed)"
						],
						"outputs": [],
						"execution_count": 39
					},
					{
						"cell_type": "markdown",
						"source": [
							"Next, we package the data into the format expected by SPark ML's LinearRegression. It requires a DataFrame with two columns- `features` and a column with the labels to predict (`quantity` in this case).\n",
							""
						]
					},
					{
						"cell_type": "code",
						"source": [
							"from pyspark.ml.feature import VectorAssembler\n",
							"\n",
							"vectorAssembler = VectorAssembler(inputCols = ['customerkey', 'stockitemkey'], outputCol = 'features')"
						],
						"outputs": [],
						"execution_count": 40
					},
					{
						"cell_type": "markdown",
						"metadata": {
							"nteract": {
								"transient": {
									"deleting": false
								}
							}
						},
						"source": [
							"In the following cell, we create the LinearRegression model."
						]
					},
					{
						"cell_type": "code",
						"metadata": {
							"jupyter": {
								"outputs_hidden": false,
								"source_hidden": false
							},
							"nteract": {
								"transient": {
									"deleting": false
								}
							},
							"collapsed": true
						},
						"source": [
							"from pyspark.ml.regression import LinearRegression\n",
							"\n",
							"lin_reg = LinearRegression(featuresCol = 'features', labelCol='quantity', maxIter = 10, regParam=0.3)"
						],
						"outputs": [],
						"execution_count": 41
					},
					{
						"cell_type": "markdown",
						"metadata": {
							"nteract": {
								"transient": {
									"deleting": false
								}
							}
						},
						"source": [
							"Next, we build the training pipeline."
						]
					},
					{
						"cell_type": "code",
						"metadata": {
							"jupyter": {
								"outputs_hidden": false,
								"source_hidden": false
							},
							"nteract": {
								"transient": {
									"deleting": false
								}
							},
							"collapsed": true
						},
						"source": [
							"from pyspark.ml import Pipeline\n",
							"\n",
							"stages = []\n",
							"stages += [vectorAssembler]\n",
							"stages += [lin_reg]\n",
							"\n",
							"partialPipeline = Pipeline().setStages(stages)"
						],
						"outputs": [],
						"execution_count": 42
					},
					{
						"cell_type": "markdown",
						"source": [
							"In the following cell, we train our LinearRegression model.\n",
							""
						]
					},
					{
						"cell_type": "code",
						"source": [
							"pipelineModel = partialPipeline.fit(df_train)\n",
							"\n",
							"print(\"Coefficients: \" + str(pipelineModel.stages[-1].coefficients))\n",
							"print(\"Intercept: \" + str(pipelineModel.stages[-1].intercept))"
						],
						"outputs": [],
						"execution_count": 43
					},
					{
						"cell_type": "markdown",
						"source": [
							"With a trained model in hand, we can use it to make predictions against the test DataFrame.\n",
							""
						]
					},
					{
						"cell_type": "code",
						"metadata": {
							"collapsed": false
						},
						"source": [
							"df_pred = pipelineModel.transform(df_test)\n",
							"\n",
							"from pyspark.sql.functions import rand\n",
							"display(df_pred.select([\"quantity\",  \"prediction\"]).orderBy(rand()).limit(5))"
						],
						"outputs": [],
						"execution_count": 44
					},
					{
						"cell_type": "markdown",
						"source": [
							"## Convert model to ONNX\n",
							"In the cells that follow, we convert the model to ONNX and show how an output of how ONNX represents the Spark ML model.\n",
							""
						]
					},
					{
						"cell_type": "code",
						"source": [
							"from onnxmltools import convert_sparkml\n",
							"from onnxmltools.convert.common.data_types import FloatTensorType\n",
							"\n",
							"initial_types = [ \n",
							"    (\"customerkey\", FloatTensorType([1, 1])),\n",
							"    (\"stockitemkey\", FloatTensorType([1, 1]))\n",
							"]"
						],
						"outputs": [],
						"execution_count": 53
					},
					{
						"cell_type": "code",
						"source": [
							"model_onnx = convert_sparkml(pipelineModel, 'sparkml GeneralizedLinearRegression', initial_types)\n",
							"model_onnx"
						],
						"outputs": [],
						"execution_count": 54
					},
					{
						"cell_type": "markdown",
						"source": [
							"## Upload the model to Azure Storage\n",
							"In the cells that follow we save the ONNX model to the storage of Spark driver node temporarily. Then we use the Azure Storage Python SDK to upload the ONNX model to Azure Storage.\n",
							""
						]
					},
					{
						"cell_type": "code",
						"source": [
							"with open(\"model.onnx\", \"wb\") as f:\n",
							"    f.write(model_onnx.SerializeToString())"
						],
						"outputs": [],
						"execution_count": 47
					},
					{
						"cell_type": "code",
						"source": [
							"connection_string = \"DefaultEndpointsProtocol=https;AccountName=<blob_storage>;AccountKey=<blob_storage_account_key>;EndpointSuffix=core.windows.net\"\n",
							"\n",
							"from azure.storage.blob import BlobClient\n",
							"\n",
							"blob = BlobClient.from_connection_string(conn_str=connection_string, container_name=\"models\", blob_name=\"onnx/model.onnx\")\n",
							"\n",
							"with open(\"./model.onnx\", \"rb\") as data:\n",
							"    blob.upload_blob(data,overwrite=True)"
						],
						"outputs": [],
						"execution_count": 48
					}
				]
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Setup Task 4 - Export Sales to Data Lake')]",
			"type": "Microsoft.Synapse/workspaces/notebooks",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "Setup"
				},
				"nbformat": 0,
				"nbformat_minor": 0,
				"bigDataPool": {
					"referenceName": "SparkPool01",
					"type": "BigDataPoolReference"
				},
				"sessionProperties": {
					"driverMemory": "28g",
					"driverCores": 4,
					"executorMemory": "28g",
					"executorCores": 4,
					"numExecutors": 2,
					"conf": {
						"spark.dynamicAllocation.enabled": "false",
						"spark.dynamicAllocation.minExecutors": "2",
						"spark.dynamicAllocation.maxExecutors": "2"
					}
				},
				"metadata": {
					"saveOutput": true,
					"synapse_widget": {
						"version": "0.1"
					},
					"kernelspec": {
						"name": "synapse_pyspark",
						"display_name": "Synapse PySpark"
					},
					"language_info": {
						"name": "python"
					},
					"a365ComputeOptions": {
						"id": "/subscriptions/03766bec-6c31-4851-aa3c-233d9b60aeaf/resourceGroups/uiap-demo-analyticsinaday-rg/providers/Microsoft.Synapse/workspaces/uiap-synapse-aid-synapsews/bigDataPools/SparkPool01",
						"name": "SparkPool01",
						"type": "Spark",
						"endpoint": "https://uiap-synapse-aid-synapsews.dev.azuresynapse.net/livyApi/versions/2019-11-01-preview/sparkPools/SparkPool01",
						"auth": {
							"type": "AAD",
							"authResource": "https://dev.azuresynapse.net"
						},
						"sparkVersion": "2.4",
						"nodeCount": 3,
						"cores": 4,
						"memory": 28
					}
				},
				"cells": [
					{
						"cell_type": "code",
						"metadata": {
							"microsoft": {
								"language": "python"
							}
						},
						"source": [
							"%%pyspark\n",
							"wwi_sales = spark \\\n",
							"    .read \\\n",
							"    .option(\"sep\",\"|\") \\\n",
							"    .load('abfss://dev@uiapsynapseaiddl.dfs.core.windows.net/bronze/wwi-factsale.csv', format=\"csv\", header=True)\n",
							"\n",
							"wwi_sales = wwi_sales \\\n",
							"    .withColumnRenamed('Sale Key', 'SaleKey') \\\n",
							"    .withColumnRenamed('City Key', 'CityKey') \\\n",
							"    .withColumnRenamed('Customer Key', 'CustomerKey') \\\n",
							"    .withColumnRenamed('Bill To Customer Key', 'BillToCustomerKey') \\\n",
							"    .withColumnRenamed('Stock Item Key', 'StockItemKey') \\\n",
							"    .withColumnRenamed('Invoice Date Key', 'InvoiceDateKey') \\\n",
							"    .withColumnRenamed('Delivery Date Key', 'DeliveryDateKey') \\\n",
							"    .withColumnRenamed('Salesperson Key', 'SalespersonKey') \\\n",
							"    .withColumnRenamed('WWI Invoice ID', 'WWIInvoiceID') \\\n",
							"    .withColumnRenamed('Description', 'Description') \\\n",
							"    .withColumnRenamed('Package', 'Package') \\\n",
							"    .withColumnRenamed('Quantity', 'Quantity') \\\n",
							"    .withColumnRenamed('Unit Price', 'UnitPrice') \\\n",
							"    .withColumnRenamed('Tax Rate', 'TaxRate') \\\n",
							"    .withColumnRenamed('Total Excluding Tax', 'TotalExcludingTax') \\\n",
							"    .withColumnRenamed('Tax Amount', 'TaxAmount') \\\n",
							"    .withColumnRenamed('Profit', 'Profit') \\\n",
							"    .withColumnRenamed('Total Including Tax', 'TotalIncludingTax') \\\n",
							"    .withColumnRenamed('Total Dry Items', 'TotalDryItems') \\\n",
							"    .withColumnRenamed('Total Chiller Items', 'TotalChillerItems') \\\n",
							"    .withColumnRenamed('Lineage Key', 'LineageKey')"
						],
						"outputs": [],
						"execution_count": 1
					},
					{
						"cell_type": "code",
						"source": [
							"import numpy as np\n",
							"from datetime import datetime\n",
							"from dateutil.relativedelta import relativedelta"
						],
						"outputs": [],
						"execution_count": 2
					},
					{
						"cell_type": "markdown",
						"source": [
							"### Export WWI sales data to parquet files\n",
							""
						]
					},
					{
						"cell_type": "code",
						"source": [
							"quarters = 20\n",
							"start_date = datetime(2012, 1, 1)\n",
							"\n",
							"for quarter in np.arange(1, quarters + 1):\n",
							"\n",
							"    quarter_number = 4 if quarter % 4 == 0 else quarter % 4\n",
							"    end_date = start_date + relativedelta(months=3) + relativedelta(days=-1)\n",
							"    \n",
							"    print(f'Exporting data for {start_date.year} Q{quarter_number} ({start_date:%Y-%m-%d} : {end_date:%Y-%m-%d}) ...')\n",
							"\n",
							"    storage_path_parquet = f'abfss://wwi@uiapsynapseaiddl.dfs.core.windows.net/factsale-parquet/{start_date.year}/Q{quarter_number}'\n",
							"\n",
							"    wwi_sales \\\n",
							"        .where((wwi_sales['InvoiceDateKey'] >= f'{start_date:%Y-%m-%d}') & (wwi_sales['InvoiceDateKey'] <= f'{end_date:%Y-%m-%d}')) \\\n",
							"        .write \\\n",
							"        .partitionBy('InvoiceDateKey') \\\n",
							"        .mode(\"overwrite\") \\\n",
							"        .parquet(storage_path_parquet)\n",
							"\n",
							"    start_date = end_date + relativedelta(days=1)"
						],
						"outputs": [],
						"execution_count": 3
					},
					{
						"cell_type": "markdown",
						"source": [
							"### Export WWI sales data to CSV files\n",
							""
						]
					},
					{
						"cell_type": "code",
						"source": [
							"quarters = 20\n",
							"start_date = datetime(2012, 1, 1)\n",
							"\n",
							"for quarter in np.arange(1, quarters + 1):\n",
							"\n",
							"    quarter_number = 4 if quarter % 4 == 0 else quarter % 4\n",
							"    end_date = start_date + relativedelta(months=3) + relativedelta(days=-1)\n",
							"    \n",
							"    print(f'Exporting data for {start_date.year} Q{quarter_number} ({start_date:%Y-%m-%d} : {end_date:%Y-%m-%d}) ...')\n",
							"\n",
							"    storage_path_csv = f'abfss://wwi@uiapsynapseaiddl.dfs.core.windows.net/factsale-csv/{start_date.year}/Q{quarter_number}'\n",
							"\n",
							"    wwi_sales \\\n",
							"        .where((wwi_sales['InvoiceDateKey'] >= f'{start_date:%Y-%m-%d}') & (wwi_sales['InvoiceDateKey'] <= f'{end_date:%Y-%m-%d}')) \\\n",
							"        .write \\\n",
							"        .partitionBy('InvoiceDateKey') \\\n",
							"        .mode(\"overwrite\") \\\n",
							"        .option(\"quote\", \"\\u0000\") \\\n",
							"        .option(\"sep\",\"|\") \\\n",
							"        .csv(storage_path_csv, header=True)\n",
							"\n",
							"    start_date = end_date + relativedelta(days=1)"
						],
						"outputs": [],
						"execution_count": 4
					}
				]
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/uiapsynapseaiddsql')]",
			"type": "Microsoft.Synapse/workspaces/sqlPools",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"collation": "SQL_Latin1_General_CP1_CI_AS",
				"maxSizeBytes": 263882790666240,
				"restorePointInTime": "0001-01-01T00:00:00",
				"annotations": []
			},
			"dependsOn": [],
			"location": "centralindia"
		}
	]
}